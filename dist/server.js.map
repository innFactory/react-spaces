{"version":3,"file":"server.js","sources":["../src/core-types.ts","../src/core-utils.ts","../src/core-resizing.ts","../src/core-dragging.ts","../src/core.ts","../src/core-react.ts","../src/components/Centered.tsx","../src/components/CenteredVertically.tsx","../src/components/Space.tsx","../src/components/Anchored.tsx","../src/components/Custom.tsx","../src/components/Fill.tsx","../src/components/Fixed.tsx","../src/components/Layer.tsx","../src/components/Positioned.tsx","../src/components/SpaceInfo.tsx","../src/components/ViewPort.tsx","../src/components/SSR.tsx","../src/components/Options.tsx"],"sourcesContent":["export type ResizeMouseEvent = React.MouseEvent<HTMLElement, MouseEvent>;\r\nexport type ResizeTouchEvent = React.TouchEvent<HTMLElement>;\r\nexport type OnResizeStart = ((resizeType?: ResizeType) => void | boolean) | undefined;\r\nexport type OnResizeEnd = ((newSize: SizeUnit, domRect: DOMRect, resizeType?: ResizeType) => void) | undefined;\r\nexport type OnDragEnd = (position: IPosition, moved: boolean) => void;\r\n\r\nexport enum Type {\r\n\tViewPort = \"viewport\",\r\n\tFixed = \"fixed\",\r\n\tFill = \"fill\",\r\n\tPositioned = \"positioned\",\r\n\tAnchored = \"anchored\",\r\n\tCustom = \"custom\",\r\n}\r\n\r\nexport enum AnchorType {\r\n\tLeft = \"anchor-left\",\r\n\tRight = \"anchor-right\",\r\n\tTop = \"anchor-top\",\r\n\tBottom = \"anchor-bottom\",\r\n}\r\n\r\nexport enum Orientation {\r\n\tHorizontal,\r\n\tVertical,\r\n}\r\n\r\nexport type SizeUnit = number | string | undefined;\r\n\r\nexport enum ResizeType {\r\n\tAll = \"resize-all\",\r\n\tLeft = \"resize-left\",\r\n\tRight = \"resize-right\",\r\n\tTop = \"resize-top\",\r\n\tBottom = \"resize-bottom\",\r\n\tTopLeft = \"resize-topleft\",\r\n\tTopRight = \"resize-topright\",\r\n\tBottomLeft = \"resize-bottomleft\",\r\n\tBottomRight = \"resize-bottomright\",\r\n}\r\n\r\nexport enum ResizeHandlePlacement {\r\n\tOverlayInside = \"overlay-inside\",\r\n\tInside = \"inside\",\r\n\tOverlayBoundary = \"overlay-boundary\",\r\n}\r\n\r\nexport enum CenterType {\r\n\tNone = \"none\",\r\n\tVertical = \"vertical\",\r\n\tHorizontalVertical = \"horizontalVertical\",\r\n}\r\n\r\nexport enum MoveEvent {\r\n\tMouse = \"mousemove\",\r\n\tTouch = \"touchmove\",\r\n}\r\n\r\nexport enum EndEvent {\r\n\tMouse = \"mouseup\",\r\n\tTouch = \"touchend\",\r\n}\r\n\r\nexport interface ICommonProps {\r\n\tid?: string;\r\n\tclassName?: string;\r\n\tcenterContent?: CenterType;\r\n\tzIndex?: number;\r\n\tscrollable?: boolean;\r\n\ttrackSize?: boolean;\r\n\tallowOverflow?: boolean;\r\n}\r\n\r\nexport interface ISpaceProps extends ICommonProps {\r\n\ttype: Type;\r\n\tanchor?: AnchorType | undefined;\r\n\torder?: number | undefined;\r\n\tposition?: IPositionalProps | undefined;\r\n\thandleSize?: number | undefined;\r\n\thandlePlacement?: ResizeHandlePlacement;\r\n\ttouchHandleSize?: number | undefined;\r\n\tminimumSize?: number | undefined;\r\n\tmaximumSize?: number | undefined;\r\n\tonResizeStart?: OnResizeStart;\r\n\tonResizeEnd?: OnResizeEnd;\r\n}\r\n\r\nexport interface ISpaceStore {\r\n\tgetSpaces: () => ISpaceDefinition[];\r\n\tgetSpace: (id: string) => ISpaceDefinition | undefined;\r\n\taddSpace: (space: ISpaceDefinition) => void;\r\n\tupdateSpace: (space: ISpaceDefinition, props: ISpaceProps) => void;\r\n\tupdateStyles: (space: ISpaceDefinition) => void;\r\n\tremoveSpace: (space: ISpaceDefinition) => void;\r\n\tcreateSpace: (parent: string | undefined, props: ISpaceProps, update: () => void) => ISpaceDefinition;\r\n\tstartMouseResize: (resizeType: ResizeType, space: ISpaceDefinition, event: React.MouseEvent<HTMLElement>, onResizeEnd?: OnResizeEnd) => void;\r\n\tstartTouchResize: (resizeType: ResizeType, space: ISpaceDefinition, event: React.TouchEvent<HTMLElement>, onResizeEnd?: OnResizeEnd) => void;\r\n\tstartMouseDrag: (space: ISpaceDefinition, event: ResizeMouseEvent, onDragEnd?: OnDragEnd) => void;\r\n\tstartTouchDrag: (space: ISpaceDefinition, event: ResizeTouchEvent, onDragEnd?: OnDragEnd) => void;\r\n}\r\n\r\nexport interface IPosition {\r\n\tleft?: SizeUnit | undefined;\r\n\ttop?: SizeUnit | undefined;\r\n\tright?: SizeUnit | undefined;\r\n\tbottom?: SizeUnit | undefined;\r\n\twidth?: SizeUnit | undefined;\r\n\theight?: SizeUnit | undefined;\r\n}\r\n\r\nexport interface IPositionalProps extends IPosition {\r\n\tleftResizable?: boolean;\r\n\ttopResizable?: boolean;\r\n\trightResizable?: boolean;\r\n\tbottomResizable?: boolean;\r\n\ttopLeftResizable?: boolean;\r\n\ttopRightResizable?: boolean;\r\n\tbottomLeftResizable?: boolean;\r\n\tbottomRightResizable?: boolean;\r\n}\r\n\r\nexport interface ISize {\r\n\tsize: SizeUnit;\r\n\tadjusted: SizeUnit[];\r\n\tresized: number;\r\n}\r\n\r\nexport interface ISpaceDefinition {\r\n\tupdate: () => void;\r\n\tupdateParent: () => void;\r\n\tadjustLeft: (adjusted: SizeUnit[]) => boolean;\r\n\tadjustRight: (adjusted: SizeUnit[]) => boolean;\r\n\tadjustTop: (adjusted: SizeUnit[]) => boolean;\r\n\tadjustBottom: (adjusted: SizeUnit[]) => boolean;\r\n\tadjustEdge: (adjusted: SizeUnit[]) => boolean;\r\n\tanchoredChildren: (children: ISpaceDefinition[], anchor: AnchorType, zIndex: number) => ISpaceDefinition[];\r\n\tonResizeStart?: OnResizeStart;\r\n\tonResizeEnd?: OnResizeEnd;\r\n\telement: HTMLElement;\r\n\tid: string;\r\n\ttype: Type;\r\n\tanchor?: AnchorType;\r\n\torientation: Orientation;\r\n\tscrollable: boolean;\r\n\torder?: number;\r\n\tposition: \"fixed\" | \"absolute\" | \"relative\";\r\n\tchildren: ISpaceDefinition[];\r\n\tparentId: string | undefined;\r\n\tstore: ISpaceStore;\r\n\tleft: ISize;\r\n\ttop: ISize;\r\n\tright: ISize;\r\n\tbottom: ISize;\r\n\twidth: ISize;\r\n\theight: ISize;\r\n\tzIndex: number;\r\n\tdimension: DOMRect;\r\n\tcenterContent: \"none\" | \"vertical\" | \"horizontalVertical\";\r\n\tresizing: boolean;\r\n\tminimumSize?: number;\r\n\tmaximumSize?: number;\r\n\thandleSize: number;\r\n\ttouchHandleSize: number;\r\n\thandlePlacement: ResizeHandlePlacement;\r\n\tcanResizeTop: boolean;\r\n\tcanResizeLeft: boolean;\r\n\tcanResizeRight: boolean;\r\n\tcanResizeBottom: boolean;\r\n\tcanResizeTopLeft: boolean;\r\n\tcanResizeTopRight: boolean;\r\n\tcanResizeBottomLeft: boolean;\r\n\tcanResizeBottomRight: boolean;\r\n\tallowOverflow: boolean;\r\n\tssrStyle: string;\r\n}\r\n\r\nexport interface ISpaceContext {\r\n\tsize: DOMRect;\r\n\tlayer: number;\r\n\tstartMouseDrag: (e: ResizeMouseEvent, onDragEnd?: OnDragEnd) => void;\r\n\tstartTouchDrag: (e: ResizeTouchEvent, onDragEnd?: OnDragEnd) => void;\r\n\tforceUpdate: () => void;\r\n\tssrStyle?: string;\r\n}\r\n","import { ISpaceDefinition, SizeUnit, ISize, ResizeHandlePlacement, Type, Orientation } from \"./core-types\";\r\n\r\nexport function omit<K extends string, T extends Record<K, unknown>>(object: T, ...keys: K[]): Omit<T, K> {\r\n\tconst keySet = Object.create(null) as Record<K, true>;\r\n\tkeys.forEach((key) => {\r\n\t\tkeySet[key] = true;\r\n\t});\r\n\r\n\tconst result = Object.create(null) as Omit<T, K>;\r\n\tObject.keys(object).forEach((key) => {\r\n\t\tif (!keySet[key]) {\r\n\t\t\tresult[key] = object[key];\r\n\t\t}\r\n\t});\r\n\r\n\treturn result;\r\n}\r\n\r\nexport function shortuuid() {\r\n\tlet firstPart = (Math.random() * 46656) | 0;\r\n\tlet secondPart = (Math.random() * 46656) | 0;\r\n\treturn (\"000\" + firstPart.toString(36)).slice(-3) + (\"000\" + secondPart.toString(36)).slice(-3);\r\n}\r\n\r\nexport function getSizeString(size: SizeUnit) {\r\n\treturn typeof size === \"string\" ? size : `${size}px`;\r\n}\r\n\r\nexport function css(size: ISize, dontAddCalc?: boolean) {\r\n\tif (size.size === 0 && size.adjusted.length === 0 && size.resized === 0) {\r\n\t\treturn `0px`;\r\n\t}\r\n\r\n\tconst parts: string[] = [];\r\n\tif (size.size !== undefined) {\r\n\t\tparts.push(getSizeString(size.size));\r\n\t}\r\n\r\n\tsize.adjusted.forEach((l) => parts.push(getSizeString(l)));\r\n\r\n\tif (size.resized !== 0) {\r\n\t\tparts.push(getSizeString(size.resized));\r\n\t}\r\n\r\n\tif (parts.length === 0) {\r\n\t\treturn undefined;\r\n\t}\r\n\r\n\tif (parts.length === 1) {\r\n\t\treturn parts[0];\r\n\t}\r\n\r\n\tif (dontAddCalc) {\r\n\t\treturn parts.join(\" + \");\r\n\t}\r\n\r\n\treturn `calc(${parts.join(\" + \")})`;\r\n}\r\n\r\nexport function coalesce<T>(...args: T[]) {\r\n\treturn args.find((x) => x !== null && x !== undefined);\r\n}\r\n\r\nexport function adjustmentsEqual(item1: SizeUnit[], item2: SizeUnit[]) {\r\n\tif (item1.length !== item2.length) {\r\n\t\treturn false;\r\n\t}\r\n\r\n\tfor (var i = 0, len = item1.length; i < len; i++) {\r\n\t\tif (item1[i] !== item2[i]) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\treturn true;\r\n}\r\n\r\nexport function throttle<F extends (...args: any) => any>(callback: F, limit: number) {\r\n\tvar wait = false; // Initially, we're not waiting\r\n\treturn function(...args: any) {\r\n\t\t// We return a throttled function\r\n\t\tif (!wait) {\r\n\t\t\t// If we're not waiting\r\n\t\t\tcallback(...args); // Execute users function\r\n\t\t\twait = true; // Prevent future invocations\r\n\t\t\tsetTimeout(function() {\r\n\t\t\t\t// After a period of time\r\n\t\t\t\twait = false; // And allow future invocations\r\n\t\t\t}, limit);\r\n\t\t}\r\n\t};\r\n}\r\n\r\nexport function styleDefinition(space: ISpaceDefinition) {\r\n\tconst cssElements: string[] = [];\r\n\r\n\tconst style: React.CSSProperties = {\r\n\t\tposition: space.position,\r\n\t\tleft: css(space.left),\r\n\t\ttop: css(space.top),\r\n\t\tright: css(space.right),\r\n\t\tbottom: css(space.bottom),\r\n\t\twidth: css(space.width),\r\n\t\theight: css(space.height),\r\n\t\tzIndex: space.zIndex,\r\n\t};\r\n\r\n\tconst cssString: string[] = [];\r\n\r\n\tif (style.position) {\r\n\t\tcssString.push(`position: ${style.position};`);\r\n\t}\r\n\tif (style.left) {\r\n\t\tcssString.push(`left: ${style.left};`);\r\n\t}\r\n\tif (style.top) {\r\n\t\tcssString.push(`top: ${style.top};`);\r\n\t}\r\n\tif (style.right) {\r\n\t\tcssString.push(`right: ${style.right};`);\r\n\t}\r\n\tif (style.bottom) {\r\n\t\tcssString.push(`bottom: ${style.bottom};`);\r\n\t}\r\n\tif (style.width) {\r\n\t\tcssString.push(`width: ${style.width};`);\r\n\t}\r\n\tif (style.height) {\r\n\t\tcssString.push(`height: ${style.height};`);\r\n\t}\r\n\tif (style.zIndex) {\r\n\t\tcssString.push(`z-index: ${style.zIndex};`);\r\n\t}\r\n\tif (space.allowOverflow) {\r\n\t\tcssString.push(\"overflow: visible;\");\r\n\t}\r\n\r\n\tif (cssString.length > 0) {\r\n\t\tcssElements.push(`#${space.id} { ${cssString.join(\" \")} }`);\r\n\t}\r\n\r\n\tif (space.scrollable) {\r\n\t\tcssElements.push(`#${space.id} > .spaces-space-inner { overflow: auto; touch-action: auto; }`);\r\n\t}\r\n\r\n\tlet nhandleOffset = 0;\r\n\tconst handleSize = `${space.handleSize}px`;\r\n\tconst touchHandleSize = `-${space.touchHandleSize / 2 - space.handleSize / 2}px`;\r\n\tconst negativeTouchHandleSize = `${space.touchHandleSize / 2 - space.handleSize / 2}px`;\r\n\r\n\tswitch (space.handlePlacement) {\r\n\t\tcase ResizeHandlePlacement.Inside:\r\n\t\tcase ResizeHandlePlacement.OverlayInside:\r\n\t\t\tnhandleOffset = space.handleSize;\r\n\t\t\tif (space.type === Type.Positioned) {\r\n\t\t\t\tnhandleOffset = 0;\r\n\t\t\t}\r\n\t\t\tbreak;\r\n\t\tcase ResizeHandlePlacement.OverlayBoundary:\r\n\t\t\tnhandleOffset = space.handleSize / 2;\r\n\t\t\tbreak;\r\n\t}\r\n\r\n\tconst handleOffset = `${nhandleOffset}px`;\r\n\r\n\tconst addHandleCss = (id: string, pos: { left?: string; top?: string; right?: string; bottom?: string; width?: string; height?: string }) => {\r\n\t\tconst styles: string[] = [];\r\n\r\n\t\tif (pos.left) styles.push(`left: ${pos.left}`);\r\n\t\tif (pos.top) styles.push(`top: ${pos.top}`);\r\n\t\tif (pos.right) styles.push(`right: ${pos.right}`);\r\n\t\tif (pos.bottom) styles.push(`bottom: ${pos.bottom}`);\r\n\t\tif (pos.width) styles.push(`width: ${pos.width}`);\r\n\t\tif (pos.height) styles.push(`height: ${pos.height}`);\r\n\r\n\t\tcssElements.push(`#${space.id}-${id} { ${styles.join(\"; \")}}`);\r\n\t};\r\n\r\n\tconst widthOrHeightSpecified = () =>\r\n\t\tspace.type === Type.Positioned\r\n\t\t\t? space.width.size && space.height.size\r\n\t\t\t: space.orientation == Orientation.Horizontal\r\n\t\t\t? space.width.size\r\n\t\t\t: space.height.size;\r\n\r\n\tif (space.canResizeLeft) {\r\n\t\tif (space.anchor) {\r\n\t\t\taddHandleCss(\"ml\", {\r\n\t\t\t\tright: `calc(${css(space.right, true)} + ${css(space.width)} - ${handleOffset})`,\r\n\t\t\t\ttop: `0`,\r\n\t\t\t\tbottom: `0`,\r\n\t\t\t\twidth: handleSize,\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\taddHandleCss(\"ml\", {\r\n\t\t\t\tleft: `calc(${css(space.left, true)} - ${handleOffset})`,\r\n\t\t\t\ttop: css(space.top),\r\n\t\t\t\tbottom: css(space.bottom),\r\n\t\t\t\twidth: handleSize,\r\n\t\t\t\theight: css(space.height),\r\n\t\t\t});\r\n\t\t}\r\n\t\taddHandleCss(\"ml:after\", {\r\n\t\t\tleft: touchHandleSize,\r\n\t\t\tright: touchHandleSize,\r\n\t\t\ttop: touchHandleSize,\r\n\t\t\tbottom: touchHandleSize,\r\n\t\t});\r\n\t}\r\n\r\n\tif (space.canResizeTop) {\r\n\t\tif (space.anchor) {\r\n\t\t\taddHandleCss(\"mt\", {\r\n\t\t\t\tleft: `0`,\r\n\t\t\t\tright: `0`,\r\n\t\t\t\tbottom: `calc(${css(space.bottom)} + ${css(space.height)} - ${handleOffset})`,\r\n\t\t\t\theight: handleSize,\r\n\t\t\t});\r\n\t\t\taddHandleCss(\"mt:after\", {\r\n\t\t\t\ttop: touchHandleSize,\r\n\t\t\t\tbottom: touchHandleSize,\r\n\t\t\t\tleft: touchHandleSize,\r\n\t\t\t\twidth: css(space.width),\r\n\t\t\t\tright: touchHandleSize,\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\taddHandleCss(\"mt\", {\r\n\t\t\t\ttop: `calc(${css(space.top, true)} - ${handleOffset})`,\r\n\t\t\t\tleft: css(space.left),\r\n\t\t\t\tright: css(space.right),\r\n\t\t\t\twidth: css(space.width),\r\n\t\t\t\theight: handleSize,\r\n\t\t\t});\r\n\t\t\tif (widthOrHeightSpecified()) {\r\n\t\t\t\taddHandleCss(\"mt:after\", {\r\n\t\t\t\t\ttop: touchHandleSize,\r\n\t\t\t\t\tbottom: touchHandleSize,\r\n\t\t\t\t\tleft: touchHandleSize,\r\n\t\t\t\t\twidth: `calc(${css(space.width, true)} - ${handleOffset}) + ${negativeTouchHandleSize}`,\r\n\t\t\t\t\tright: touchHandleSize,\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\taddHandleCss(\"mt:after\", {\r\n\t\t\t\t\ttop: touchHandleSize,\r\n\t\t\t\t\tbottom: touchHandleSize,\r\n\t\t\t\t\tleft: touchHandleSize,\r\n\t\t\t\t\twidth: css(space.width),\r\n\t\t\t\t\tright: touchHandleSize,\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tif (space.canResizeRight) {\r\n\t\tif (widthOrHeightSpecified()) {\r\n\t\t\taddHandleCss(\"mr\", {\r\n\t\t\t\tleft: `calc(${css(space.left, true)} + ${css(space.width, true)} - ${handleSize} + ${handleOffset})`,\r\n\t\t\t\ttop: css(space.top),\r\n\t\t\t\tbottom: css(space.bottom),\r\n\t\t\t\twidth: handleSize,\r\n\t\t\t\theight: css(space.height),\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\taddHandleCss(\"mr\", {\r\n\t\t\t\tright: `calc(${css(space.right, true)} - ${handleOffset})`,\r\n\t\t\t\ttop: css(space.top),\r\n\t\t\t\tbottom: css(space.bottom),\r\n\t\t\t\twidth: handleSize,\r\n\t\t\t\theight: css(space.height),\r\n\t\t\t});\r\n\t\t}\r\n\t\taddHandleCss(\"mr:after\", {\r\n\t\t\tleft: touchHandleSize,\r\n\t\t\tright: touchHandleSize,\r\n\t\t\ttop: touchHandleSize,\r\n\t\t\tbottom: touchHandleSize,\r\n\t\t});\r\n\t}\r\n\r\n\tif (space.canResizeBottom) {\r\n\t\tif (widthOrHeightSpecified()) {\r\n\t\t\taddHandleCss(\"mb\", {\r\n\t\t\t\ttop: `calc(${css(space.top, true)} + ${css(space.height, true)} - ${handleSize} + ${handleOffset})`,\r\n\t\t\t\tleft: css(space.left),\r\n\t\t\t\tright: css(space.right),\r\n\t\t\t\twidth: css(space.width),\r\n\t\t\t\theight: handleSize,\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\taddHandleCss(\"mb\", {\r\n\t\t\t\tbottom: `calc(${css(space.bottom, true)} - ${handleOffset})`,\r\n\t\t\t\tleft: css(space.left),\r\n\t\t\t\tright: css(space.right),\r\n\t\t\t\twidth: css(space.width),\r\n\t\t\t\theight: handleSize,\r\n\t\t\t});\r\n\t\t}\r\n\t\taddHandleCss(\"mb:after\", {\r\n\t\t\ttop: touchHandleSize,\r\n\t\t\tbottom: touchHandleSize,\r\n\t\t\tleft: touchHandleSize,\r\n\t\t\tright: touchHandleSize,\r\n\t\t});\r\n\t}\r\n\r\n\tif (space.canResizeTopLeft) {\r\n\t\taddHandleCss(\"mtl\", {\r\n\t\t\tleft: `calc(${css(space.left, true)} - ${handleOffset})`,\r\n\t\t\ttop: css(space.top),\r\n\t\t\twidth: handleSize,\r\n\t\t\theight: handleSize,\r\n\t\t});\r\n\t\taddHandleCss(\"mtl:after\", {\r\n\t\t\ttop: touchHandleSize,\r\n\t\t\tbottom: touchHandleSize,\r\n\t\t\tleft: touchHandleSize,\r\n\t\t\tright: touchHandleSize,\r\n\t\t});\r\n\t}\r\n\r\n\tif (space.canResizeTopRight) {\r\n\t\tif (widthOrHeightSpecified()) {\r\n\t\t\taddHandleCss(\"mtr\", {\r\n\t\t\t\tleft: `calc(${css(space.left, true)} + ${css(space.width, true)} - ${handleSize} + ${handleOffset})`,\r\n\t\t\t\ttop: css(space.top),\r\n\t\t\t\twidth: handleSize,\r\n\t\t\t\theight: handleSize,\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\taddHandleCss(\"mtr\", {\r\n\t\t\t\tright: `calc(${css(space.right, true)} - ${handleOffset})`,\r\n\t\t\t\ttop: css(space.top),\r\n\t\t\t\twidth: handleSize,\r\n\t\t\t\theight: handleSize,\r\n\t\t\t});\r\n\t\t}\r\n\t\taddHandleCss(\"mtr:after\", {\r\n\t\t\ttop: touchHandleSize,\r\n\t\t\tbottom: touchHandleSize,\r\n\t\t\tleft: touchHandleSize,\r\n\t\t\tright: touchHandleSize,\r\n\t\t});\r\n\t}\r\n\r\n\tif (space.canResizeBottomLeft) {\r\n\t\tif (widthOrHeightSpecified()) {\r\n\t\t\taddHandleCss(\"mbl\", {\r\n\t\t\t\ttop: `calc(${css(space.top, true)} + ${css(space.height, true)} - ${handleSize} + ${handleOffset})`,\r\n\t\t\t\tleft: css(space.left),\r\n\t\t\t\twidth: handleSize,\r\n\t\t\t\theight: handleSize,\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\taddHandleCss(\"mbl\", {\r\n\t\t\t\tbottom: `calc(${css(space.bottom, true)} - ${handleOffset})`,\r\n\t\t\t\tleft: css(space.left),\r\n\t\t\t\twidth: handleSize,\r\n\t\t\t\theight: handleSize,\r\n\t\t\t});\r\n\t\t}\r\n\t\taddHandleCss(\"mbl:after\", {\r\n\t\t\ttop: touchHandleSize,\r\n\t\t\tbottom: touchHandleSize,\r\n\t\t\tleft: touchHandleSize,\r\n\t\t\tright: touchHandleSize,\r\n\t\t});\r\n\t}\r\n\r\n\tif (space.canResizeBottomRight) {\r\n\t\tif (widthOrHeightSpecified()) {\r\n\t\t\taddHandleCss(\"mbr\", {\r\n\t\t\t\tleft: `calc(${css(space.left, true)} + ${css(space.width, true)} - ${handleSize} + ${handleOffset})`,\r\n\t\t\t\ttop: `calc(${css(space.top, true)} + ${css(space.height, true)} - ${handleSize} + ${handleOffset})`,\r\n\t\t\t\twidth: handleSize,\r\n\t\t\t\theight: handleSize,\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\taddHandleCss(\"mbr\", {\r\n\t\t\t\tright: `calc(${css(space.right, true)} - ${handleOffset})`,\r\n\t\t\t\tbottom: `calc(${css(space.bottom, true)} - ${handleOffset})`,\r\n\t\t\t\twidth: handleSize,\r\n\t\t\t\theight: handleSize,\r\n\t\t\t});\r\n\t\t}\r\n\t\taddHandleCss(\"mbr:after\", {\r\n\t\t\ttop: touchHandleSize,\r\n\t\t\tbottom: touchHandleSize,\r\n\t\t\tleft: touchHandleSize,\r\n\t\t\tright: touchHandleSize,\r\n\t\t});\r\n\t}\r\n\r\n\treturn cssElements.join(\" \");\r\n}\r\n\r\nexport function updateStyleDefinition(space: ISpaceDefinition) {\r\n\tconst definition = styleDefinition(space);\r\n\tif (!isServer()) {\r\n\t\tconst existing = document.getElementById(`style_${space.id}`);\r\n\t\tif (existing) {\r\n\t\t\tif (existing.innerHTML !== definition) {\r\n\t\t\t\texisting.innerHTML = definition;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tconst newStyle = document.createElement(\"style\");\r\n\t\t\tnewStyle.id = `style_${space.id}`;\r\n\t\t\tnewStyle.innerHTML = definition;\r\n\t\t\tdocument.head.appendChild(newStyle);\r\n\t\t}\r\n\t} else {\r\n\t\tspace.ssrStyle = definition;\r\n\t}\r\n}\r\n\r\nexport function removeStyleDefinition(space: ISpaceDefinition) {\r\n\tconst existing = document.getElementById(`style_${space.id}`);\r\n\tif (existing) {\r\n\t\tdocument.head.removeChild(existing);\r\n\t}\r\n}\r\n\r\nexport function isServer() {\r\n\tif (typeof document !== \"undefined\") {\r\n\t\tif (document) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\treturn true;\r\n}\r\n","import { SyntheticEvent } from \"react\";\r\nimport { ISpaceDefinition, ResizeType, ISpaceStore, OnResizeEnd, EndEvent, MoveEvent, Type, ISize } from \"./core-types\";\r\nimport { coalesce, throttle } from \"./core-utils\";\r\n\r\nconst RESIZE_THROTTLE = 0;\r\n\r\nexport interface IResizeChange {\r\n\tx: number;\r\n\ty: number;\r\n}\r\n\r\nfunction isHorizontal(resizeType: ResizeType) {\r\n\treturn resizeType === ResizeType.Left || resizeType === ResizeType.Right;\r\n}\r\n\r\ntype ResizeAdjuster = (currentX: number, currentY: number) => void;\r\n\r\nfunction createSideAdjuster(\r\n\trect: DOMRect,\r\n\tresizeType: ResizeType,\r\n\tdimensionToAdjust: ISize,\r\n\tspace: ISpaceDefinition,\r\n\toriginalX: number,\r\n\toriginalY: number,\r\n): ResizeAdjuster {\r\n\tconst negater = resizeType === ResizeType.Right || resizeType === ResizeType.Bottom ? (val: number) => -val : (val: number) => val;\r\n\r\n\tconst candidateOppositeDimensionToAdjust = isHorizontal(resizeType) ? space.width : space.height;\r\n\r\n\tconst offset1 = dimensionToAdjust.resized;\r\n\tconst offset2 = candidateOppositeDimensionToAdjust.resized;\r\n\r\n\tconst size = isHorizontal(resizeType) ? rect.width : rect.height;\r\n\tconst minimumAdjust = coalesce(space.minimumSize, 20)! - size + 0;\r\n\tconst maximumAdjust = space.maximumSize ? space.maximumSize - size + 0 : undefined;\r\n\r\n\treturn (currentX: number, currentY: number) => {\r\n\t\tlet adjustment = (isHorizontal(resizeType) ? originalX : originalY) - (isHorizontal(resizeType) ? currentX : currentY);\r\n\t\tlet dimensionResized = negater(adjustment);\r\n\r\n\t\tif (space.type !== Type.Positioned) {\r\n\t\t\tdimensionResized = Math.max(negater(adjustment), minimumAdjust);\r\n\r\n\t\t\tif (dimensionResized < minimumAdjust) {\r\n\t\t\t\tdimensionResized = minimumAdjust;\r\n\t\t\t}\r\n\r\n\t\t\tif (typeof maximumAdjust === \"number\") {\r\n\t\t\t\tif (dimensionResized > maximumAdjust) {\r\n\t\t\t\t\tdimensionResized = maximumAdjust;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (dimensionToAdjust.size !== undefined) {\r\n\t\t\tdimensionToAdjust.resized = negater(-adjustment) + offset1;\r\n\t\t\tif (candidateOppositeDimensionToAdjust.size) {\r\n\t\t\t\tcandidateOppositeDimensionToAdjust.resized = negater(adjustment) + offset2;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tcandidateOppositeDimensionToAdjust.resized = dimensionResized + offset2;\r\n\t\t}\r\n\t};\r\n}\r\n\r\nfunction createAdjuster(resizeType: ResizeType, space: ISpaceDefinition, originalX: number, originalY: number): ResizeAdjuster {\r\n\tconst rect = space.element.getBoundingClientRect();\r\n\tswitch (resizeType) {\r\n\t\tcase ResizeType.Left:\r\n\t\t\treturn createSideAdjuster(rect, resizeType, space.left, space, originalX, originalY);\r\n\t\tcase ResizeType.Right:\r\n\t\t\treturn createSideAdjuster(rect, resizeType, space.right, space, originalX, originalY);\r\n\t\tcase ResizeType.Bottom:\r\n\t\t\treturn createSideAdjuster(rect, resizeType, space.bottom, space, originalX, originalY);\r\n\t\tcase ResizeType.Top:\r\n\t\t\treturn createSideAdjuster(rect, resizeType, space.top, space, originalX, originalY);\r\n\t\tcase ResizeType.TopLeft:\r\n\t\t\tconst topAdjuster = createSideAdjuster(rect, ResizeType.Top, space.top, space, originalX, originalY);\r\n\t\t\tconst leftAdjuster = createSideAdjuster(rect, ResizeType.Left, space.left, space, originalX, originalY);\r\n\t\t\treturn (x, y) => {\r\n\t\t\t\ttopAdjuster(x, y);\r\n\t\t\t\tleftAdjuster(x, y);\r\n\t\t\t};\r\n\t\tcase ResizeType.TopRight:\r\n\t\t\tconst top1Adjuster = createSideAdjuster(rect, ResizeType.Top, space.top, space, originalX, originalY);\r\n\t\t\tconst rightAdjuster = createSideAdjuster(rect, ResizeType.Right, space.right, space, originalX, originalY);\r\n\t\t\treturn (x, y) => {\r\n\t\t\t\ttop1Adjuster(x, y);\r\n\t\t\t\trightAdjuster(x, y);\r\n\t\t\t};\r\n\t\tcase ResizeType.BottomLeft:\r\n\t\t\tconst bottomAdjuster = createSideAdjuster(rect, ResizeType.Bottom, space.bottom, space, originalX, originalY);\r\n\t\t\tconst left1Adjuster = createSideAdjuster(rect, ResizeType.Left, space.left, space, originalX, originalY);\r\n\t\t\treturn (x, y) => {\r\n\t\t\t\tbottomAdjuster(x, y);\r\n\t\t\t\tleft1Adjuster(x, y);\r\n\t\t\t};\r\n\t\tcase ResizeType.BottomRight:\r\n\t\t\tconst bottom1Adjuster = createSideAdjuster(rect, ResizeType.Bottom, space.bottom, space, originalX, originalY);\r\n\t\t\tconst right1Adjuster = createSideAdjuster(rect, ResizeType.Right, space.right, space, originalX, originalY);\r\n\t\t\treturn (x, y) => {\r\n\t\t\t\tbottom1Adjuster(x, y);\r\n\t\t\t\tright1Adjuster(x, y);\r\n\t\t\t};\r\n\t\tdefault:\r\n\t\t\tthrow `Resize type ${resizeType} not supported`;\r\n\t}\r\n}\r\n\r\nexport function createResize(store: ISpaceStore) {\r\n\treturn {\r\n\t\tstartResize<T extends SyntheticEvent<HTMLElement> | MouseEvent | TouchEvent>(\r\n\t\t\te: T,\r\n\t\t\tresizeType: ResizeType,\r\n\t\t\tspace: ISpaceDefinition,\r\n\t\t\tendEvent: EndEvent,\r\n\t\t\tmoveEvent: MoveEvent,\r\n\t\t\tgetCoords: (event: T) => { x: number; y: number },\r\n\t\t\tonResizeEnd?: OnResizeEnd,\r\n\t\t) {\r\n\t\t\tif (space.onResizeStart) {\r\n\t\t\t\tconst result = space.onResizeStart(resizeType);\r\n\t\t\t\tif (typeof result === \"boolean\" && !result) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tconst originalCoords = getCoords(e);\r\n\t\t\tconst adjuster = createAdjuster(resizeType, space, originalCoords.x, originalCoords.y);\r\n\r\n\t\t\tspace.resizing = true;\r\n\t\t\tspace.updateParent();\r\n\r\n\t\t\tlet lastX = 0;\r\n\t\t\tlet lastY = 0;\r\n\t\t\tlet moved = false;\r\n\r\n\t\t\tconst resize = (currentX: number, currentY: number) => {\r\n\t\t\t\tadjuster(currentX, currentY);\r\n\t\t\t\tstore.updateStyles(space);\r\n\t\t\t};\r\n\r\n\t\t\tconst withPreventDefault = (e: T) => {\r\n\t\t\t\tmoved = true;\r\n\t\t\t\tconst newCoords = getCoords(e);\r\n\t\t\t\tlastX = newCoords.x;\r\n\t\t\t\tlastY = newCoords.y;\r\n\t\t\t\te.preventDefault();\r\n\r\n\t\t\t\tif (RESIZE_THROTTLE > 0) {\r\n\t\t\t\t\tthrottle(\r\n\t\t\t\t\t\t(x, y) =>\r\n\t\t\t\t\t\t\twindow.requestAnimationFrame(() => {\r\n\t\t\t\t\t\t\t\tif (space.resizing) {\r\n\t\t\t\t\t\t\t\t\tresize(x, y);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}),\r\n\t\t\t\t\t\tRESIZE_THROTTLE,\r\n\t\t\t\t\t)(lastX, lastY);\r\n\t\t\t\t} else {\r\n\t\t\t\t\twindow.requestAnimationFrame(() => {\r\n\t\t\t\t\t\tif (space.resizing) {\r\n\t\t\t\t\t\t\tresize(lastX, lastY);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\tconst removeListener = () => {\r\n\t\t\t\tspace.resizing = false;\r\n\r\n\t\t\t\tif (moved) {\r\n\t\t\t\t\tresize(lastX, lastY);\r\n\t\t\t\t}\r\n\r\n\t\t\t\twindow.removeEventListener(moveEvent, withPreventDefault as EventListener);\r\n\t\t\t\twindow.removeEventListener(endEvent, removeListener);\r\n\t\t\t\tspace.updateParent();\r\n\r\n\t\t\t\tconst resizeEnd = onResizeEnd || space.onResizeEnd;\r\n\t\t\t\tif (resizeEnd) {\r\n\t\t\t\t\tconst currentRect = space.element.getBoundingClientRect();\r\n\t\t\t\t\tresizeEnd(Math.floor(isHorizontal(resizeType) ? currentRect.width : currentRect.height), currentRect as DOMRect, resizeType);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\twindow.addEventListener(moveEvent, withPreventDefault as EventListener);\r\n\t\t\twindow.addEventListener(endEvent, removeListener);\r\n\t\t},\r\n\t};\r\n}\r\n","import { SyntheticEvent } from \"react\";\nimport { ISpaceDefinition, ISpaceStore, EndEvent, MoveEvent, OnDragEnd } from \"./core-types\";\nimport { throttle } from \"./core-utils\";\n\nexport function createDrag(store: ISpaceStore) {\n\tfunction onMove(space: ISpaceDefinition, originalX: number, originalY: number, x: number, y: number) {\n\t\tconst adjustmentX = -(originalX - x);\n\t\tconst adjustmentY = -(originalY - y);\n\n\t\tspace.left.adjusted = [adjustmentX];\n\t\tspace.top.adjusted = [adjustmentY];\n\n\t\tif (space.right.size) {\n\t\t\tspace.right.adjusted = [-adjustmentX];\n\t\t}\n\n\t\tif (space.bottom.size) {\n\t\t\tspace.bottom.adjusted = [-adjustmentY];\n\t\t}\n\n\t\tstore.updateStyles(space);\n\t}\n\n\treturn {\n\t\tstartDrag<T extends SyntheticEvent<HTMLElement> | MouseEvent | TouchEvent>(\n\t\t\te: T,\n\t\t\tspace: ISpaceDefinition,\n\t\t\tendEvent: EndEvent,\n\t\t\tmoveEvent: MoveEvent,\n\t\t\tgetCoords: (event: T) => { x: number; y: number },\n\t\t\tonDragEnd?: OnDragEnd,\n\t\t) {\n\t\t\tif (space.element) {\n\t\t\t\tconst coords = getCoords(e);\n\t\t\t\tconst adjustedLeft = space.left.adjusted.length === 0 ? 0 : (space.left.adjusted[0] as number);\n\t\t\t\tconst adjustedTop = space.top.adjusted.length === 0 ? 0 : (space.top.adjusted[0] as number);\n\t\t\t\tconst originalMouseX = coords.x - adjustedLeft;\n\t\t\t\tconst originalMouseY = coords.y - adjustedTop;\n\t\t\t\tlet lastX = 0;\n\t\t\t\tlet lastY = 0;\n\t\t\t\tlet moved = false;\n\n\t\t\t\tconst mouseMove = (x: number, y: number) => onMove(space, originalMouseX, originalMouseY, x, y);\n\t\t\t\tconst throttledMouseMove = throttle<typeof mouseMove>(mouseMove, 5);\n\n\t\t\t\tconst withPreventDefault = (e: T) => {\n\t\t\t\t\tmoved = true;\n\t\t\t\t\tconst newCoords = getCoords(e);\n\t\t\t\t\tlastX = newCoords.x;\n\t\t\t\t\tlastY = newCoords.y;\n\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\tthrottledMouseMove(lastX, lastY);\n\t\t\t\t};\n\n\t\t\t\tconst removeListener = () => {\n\t\t\t\t\tif (moved) {\n\t\t\t\t\t\tmouseMove(lastX, lastY);\n\t\t\t\t\t}\n\t\t\t\t\twindow.removeEventListener(moveEvent, withPreventDefault as EventListener);\n\t\t\t\t\twindow.removeEventListener(endEvent, removeListener);\n\n\t\t\t\t\tif (onDragEnd) {\n\t\t\t\t\t\tconst parentInfo = (space.parentId && store.getSpace(space.parentId)?.element.getBoundingClientRect()) || {\n\t\t\t\t\t\t\tleft: 0,\n\t\t\t\t\t\t\ttop: 0,\n\t\t\t\t\t\t\tright: 0,\n\t\t\t\t\t\t\tbottom: 0,\n\t\t\t\t\t\t\twidth: 0,\n\t\t\t\t\t\t\theight: 0,\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\tconst info = (({ left, top, right, bottom, width, height }) => ({ left, top, right, bottom, width, height }))(\n\t\t\t\t\t\t\tspace.element.getBoundingClientRect(),\n\t\t\t\t\t\t);\n\t\t\t\t\t\tonDragEnd(\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t...info,\n\t\t\t\t\t\t\t\t...{\n\t\t\t\t\t\t\t\t\tleft: info.left - parentInfo.left,\n\t\t\t\t\t\t\t\t\ttop: info.top - parentInfo.top,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tmoved,\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\twindow.addEventListener(moveEvent, withPreventDefault as EventListener);\n\t\t\t\twindow.addEventListener(endEvent, removeListener);\n\t\t\t}\n\t\t},\n\t};\n}\n","import {\r\n\tISpaceDefinition,\r\n\tSizeUnit,\r\n\tAnchorType,\r\n\tType,\r\n\tOrientation,\r\n\tEndEvent,\r\n\tMoveEvent,\r\n\tISpaceStore,\r\n\tISpaceProps,\r\n\tCenterType,\r\n\tResizeHandlePlacement,\r\n} from \"./core-types\";\r\nimport { createResize } from \"./core-resizing\";\r\nimport { updateStyleDefinition, removeStyleDefinition, coalesce, adjustmentsEqual } from \"./core-utils\";\r\nimport { createDrag } from \"./core-dragging\";\r\n\r\nconst spaceDefaults: Partial<ISpaceDefinition> = {\r\n\tid: \"\",\r\n\tzIndex: 0,\r\n\tscrollable: false,\r\n\tresizing: false,\r\n\tallowOverflow: false,\r\n\tcenterContent: \"none\",\r\n\tdimension: { left: 0, top: 0, right: 0, bottom: 0, width: 0, height: 0, x: 0, y: 0, toJSON: () => \"\" },\r\n\thandleSize: 5,\r\n\ttouchHandleSize: 5,\r\n\thandlePlacement: ResizeHandlePlacement.OverlayInside,\r\n\tadjustLeft: () => false,\r\n\tadjustRight: () => false,\r\n\tadjustTop: () => false,\r\n\tadjustBottom: () => false,\r\n\tadjustEdge: () => false,\r\n\tanchoredChildren: () => [],\r\n};\r\n\r\nconst anchorTypes = [AnchorType.Left, AnchorType.Top, AnchorType.Right, AnchorType.Bottom];\r\n\r\nfunction getPosition(type: Type) {\r\n\tif (type === Type.ViewPort) {\r\n\t\treturn \"fixed\";\r\n\t}\r\n\tif (type === Type.Fixed) {\r\n\t\treturn \"relative\";\r\n\t}\r\n\treturn \"absolute\";\r\n}\r\n\r\nfunction getOrientation(anchor: AnchorType | undefined) {\r\n\treturn anchor === AnchorType.Bottom || anchor === AnchorType.Top ? Orientation.Vertical : Orientation.Horizontal;\r\n}\r\n\r\nfunction anchorUpdates(space: ISpaceDefinition) {\r\n\treturn [\r\n\t\t{\r\n\t\t\tanchor: AnchorType.Left,\r\n\t\t\tupdate: space.adjustLeft,\r\n\t\t},\r\n\t\t{\r\n\t\t\tanchor: AnchorType.Top,\r\n\t\t\tupdate: space.adjustTop,\r\n\t\t},\r\n\t\t{\r\n\t\t\tanchor: AnchorType.Right,\r\n\t\t\tupdate: space.adjustRight,\r\n\t\t},\r\n\t\t{\r\n\t\t\tanchor: AnchorType.Bottom,\r\n\t\t\tupdate: space.adjustBottom,\r\n\t\t},\r\n\t];\r\n}\r\n\r\nfunction sizeInfoDefault(size: SizeUnit) {\r\n\treturn { size: size, adjusted: [], resized: 0 };\r\n}\r\n\r\nexport function createStore(): ISpaceStore {\r\n\tlet spaces: ISpaceDefinition[] = [];\r\n\r\n\tconst setSpaces = (newSpaces: ISpaceDefinition[]) => {\r\n\t\tspaces = newSpaces;\r\n\t};\r\n\r\n\tconst getSpace = (id: string) => {\r\n\t\treturn getSpaces().find((s) => s.id === id);\r\n\t};\r\n\r\n\tconst getSpaces = () => spaces;\r\n\r\n\tconst recalcSpaces = (parent: ISpaceDefinition) => {\r\n\t\tconst onlyUnique = (value: number, index: number, self: number[]) => {\r\n\t\t\treturn self.indexOf(value) === index;\r\n\t\t};\r\n\r\n\t\tconst addDefaultOrders = (spaces: ISpaceDefinition[]) => {\r\n\t\t\tlet result: ISpaceDefinition[] = [];\r\n\r\n\t\t\tanchorTypes.forEach((t) => {\r\n\t\t\t\tconst anchoredSpaces = spaces.filter((s) => s.anchor !== undefined && s.anchor === t);\r\n\t\t\t\tconst zIndices = anchoredSpaces.map((s) => s.zIndex).filter(onlyUnique);\r\n\t\t\t\tzIndices.forEach((i) => {\r\n\t\t\t\t\tconst anchoredSpacesInLayer = anchoredSpaces.filter((s) => s.zIndex === i);\r\n\t\t\t\t\tconst orderedSpaces = anchoredSpacesInLayer.filter((c) => c.order !== undefined);\r\n\t\t\t\t\tconst unorderedSpaces = anchoredSpacesInLayer.filter((c) => c.order === undefined);\r\n\t\t\t\t\tvar maxOrder = orderedSpaces.length > 0 ? orderedSpaces.map((a) => a.order!).reduce((a, b) => Math.max(a, b)) : 0;\r\n\t\t\t\t\tresult = [...result, ...[...orderedSpaces, ...unorderedSpaces.map((c, idx) => ({ ...c, ...{ order: maxOrder + idx + 1 } }))]];\r\n\t\t\t\t});\r\n\t\t\t});\r\n\r\n\t\t\treturn [...result, ...spaces.filter((s) => s.anchor === undefined)];\r\n\t\t};\r\n\r\n\t\tconst orderedSpaces = addDefaultOrders(parent.children);\r\n\t\tfor (var i = 0, len = orderedSpaces.length; i < len; i++) {\r\n\t\t\tconst space = orderedSpaces[i];\r\n\t\t\tlet changed = false;\r\n\r\n\t\t\tif (space.type === Type.Fill) {\r\n\t\t\t\tanchorUpdates(space).forEach((info) => {\r\n\t\t\t\t\tconst adjusted: SizeUnit[] = [];\r\n\t\t\t\t\tconst anchoredSpaces = parent.anchoredChildren(orderedSpaces, info.anchor, space.zIndex);\r\n\r\n\t\t\t\t\tanchoredSpaces.forEach((as) => {\r\n\t\t\t\t\t\tif (as.orientation === Orientation.Vertical) {\r\n\t\t\t\t\t\t\tif (as.height.size) {\r\n\t\t\t\t\t\t\t\tadjusted.push(as.height.size);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (as.height.resized) {\r\n\t\t\t\t\t\t\t\tadjusted.push(as.height.resized);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tif (as.width.size) {\r\n\t\t\t\t\t\t\t\tadjusted.push(as.width.size);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (as.width.resized) {\r\n\t\t\t\t\t\t\t\tadjusted.push(as.width.resized);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tif (info.update(adjusted)) {\r\n\t\t\t\t\t\tchanged = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t} else if (space.type === Type.Anchored) {\r\n\t\t\t\tconst adjusted: SizeUnit[] = [];\r\n\t\t\t\tconst anchoredSpaces = parent\r\n\t\t\t\t\t.anchoredChildren(orderedSpaces, space.anchor!, space.zIndex)\r\n\t\t\t\t\t.filter((s) => s.id !== space.id && s.order! <= space.order!);\r\n\r\n\t\t\t\tanchoredSpaces.forEach((as) => {\r\n\t\t\t\t\tif (as.orientation === Orientation.Vertical) {\r\n\t\t\t\t\t\tif (as.height.size) {\r\n\t\t\t\t\t\t\tadjusted.push(as.height.size);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (as.height.resized) {\r\n\t\t\t\t\t\t\tadjusted.push(as.height.resized);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif (as.width.size) {\r\n\t\t\t\t\t\t\tadjusted.push(as.width.size);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (as.width.resized) {\r\n\t\t\t\t\t\t\tadjusted.push(as.width.resized);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\tif (space.adjustEdge(adjusted)) {\r\n\t\t\t\t\tchanged = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (changed) {\r\n\t\t\t\tupdateStyleDefinition(space);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tconst store: ISpaceStore = {\r\n\t\tgetSpaces: getSpaces,\r\n\t\tgetSpace: getSpace,\r\n\t\taddSpace: (space) => {\r\n\t\t\tgetSpaces().push(space);\r\n\r\n\t\t\tif (space.parentId) {\r\n\t\t\t\tconst parentSpace = getSpace(space.parentId);\r\n\t\t\t\tif (parentSpace) {\r\n\t\t\t\t\tparentSpace.children.push(space);\r\n\t\t\t\t\trecalcSpaces(parentSpace);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tupdateStyleDefinition(space);\r\n\t\t},\r\n\t\tremoveSpace: (space) => {\r\n\t\t\tsetSpaces(getSpaces().filter((s) => s.id !== space.id));\r\n\r\n\t\t\tif (space.parentId) {\r\n\t\t\t\tconst parentSpace = getSpace(space.parentId);\r\n\t\t\t\tif (parentSpace) {\r\n\t\t\t\t\tparentSpace.children = parentSpace.children.filter((s) => s.id !== space.id);\r\n\t\t\t\t\trecalcSpaces(parentSpace);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tremoveStyleDefinition(space);\r\n\t\t},\r\n\t\tupdateStyles: (space) => {\r\n\t\t\tif (space.parentId) {\r\n\t\t\t\tconst parent = getSpace(space.parentId);\r\n\t\t\t\tif (parent) {\r\n\t\t\t\t\trecalcSpaces(parent);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tupdateStyleDefinition(space);\r\n\t\t},\r\n\t\tupdateSpace: (space, props) => {\r\n\t\t\tconst {\r\n\t\t\t\ttype,\r\n\t\t\t\tanchor,\r\n\t\t\t\torder,\r\n\t\t\t\tzIndex,\r\n\t\t\t\tscrollable,\r\n\t\t\t\tposition,\r\n\t\t\t\tcenterContent,\r\n\t\t\t\tminimumSize,\r\n\t\t\t\tmaximumSize,\r\n\t\t\t\thandleSize,\r\n\t\t\t\ttouchHandleSize,\r\n\t\t\t\thandlePlacement,\r\n\t\t\t\tallowOverflow,\r\n\t\t\t} = props;\r\n\t\t\tconst canResizeLeft = (position && position.leftResizable) || false;\r\n\t\t\tconst canResizeRight = (position && position.rightResizable) || false;\r\n\t\t\tconst canResizeTop = (position && position.topResizable) || false;\r\n\t\t\tconst canResizeBottom = (position && position.bottomResizable) || false;\r\n\t\t\tconst canResizeTopLeft = (position && position.topLeftResizable) || false;\r\n\t\t\tconst canResizeTopRight = (position && position.topRightResizable) || false;\r\n\t\t\tconst canResizeBottomLeft = (position && position.bottomLeftResizable) || false;\r\n\t\t\tconst canResizeBottomRight = (position && position.bottomRightResizable) || false;\r\n\r\n\t\t\tlet changed = false;\r\n\r\n\t\t\tif (space.type !== type) {\r\n\t\t\t\tspace.type = type;\r\n\t\t\t\tspace.position = getPosition(type);\r\n\t\t\t\tchanged = true;\r\n\t\t\t}\r\n\r\n\t\t\tif (space.anchor !== anchor) {\r\n\t\t\t\tspace.anchor = anchor;\r\n\t\t\t\tspace.orientation = getOrientation(anchor);\r\n\t\t\t\tchanged = true;\r\n\r\n\t\t\t\tif (type === Type.Anchored) {\r\n\t\t\t\t\tif (anchor === AnchorType.Left) {\r\n\t\t\t\t\t\tspace.adjustEdge = space.adjustLeft;\r\n\t\t\t\t\t} else if (anchor === AnchorType.Top) {\r\n\t\t\t\t\t\tspace.adjustEdge = space.adjustTop;\r\n\t\t\t\t\t} else if (anchor === AnchorType.Right) {\r\n\t\t\t\t\t\tspace.adjustEdge = space.adjustRight;\r\n\t\t\t\t\t} else if (anchor === AnchorType.Bottom) {\r\n\t\t\t\t\t\tspace.adjustEdge = space.adjustBottom;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (space.left.size !== (position && position.left)) {\r\n\t\t\t\tspace.left.size = position && position.left;\r\n\t\t\t\tspace.left.resized = 0;\r\n\t\t\t\tspace.left.adjusted = [];\r\n\t\t\t\tchanged = true;\r\n\t\t\t}\r\n\r\n\t\t\tif (space.right.size !== (position && position.right)) {\r\n\t\t\t\tspace.right.size = position && position.right;\r\n\t\t\t\tspace.right.resized = 0;\r\n\t\t\t\tspace.right.adjusted = [];\r\n\t\t\t\tchanged = true;\r\n\t\t\t}\r\n\r\n\t\t\tif (space.top.size !== (position && position.top)) {\r\n\t\t\t\tspace.top.size = position && position.top;\r\n\t\t\t\tspace.top.resized = 0;\r\n\t\t\t\tspace.top.adjusted = [];\r\n\t\t\t\tchanged = true;\r\n\t\t\t}\r\n\r\n\t\t\tif (space.bottom.size !== (position && position.bottom)) {\r\n\t\t\t\tspace.bottom.size = position && position.bottom;\r\n\t\t\t\tspace.bottom.resized = 0;\r\n\t\t\t\tspace.bottom.adjusted = [];\r\n\t\t\t\tchanged = true;\r\n\t\t\t}\r\n\r\n\t\t\tif (space.width.size !== (position && position.width)) {\r\n\t\t\t\tspace.width.size = position && position.width;\r\n\t\t\t\tspace.width.resized = 0;\r\n\t\t\t\tspace.width.adjusted = [];\r\n\t\t\t\tchanged = true;\r\n\t\t\t}\r\n\r\n\t\t\tif (space.height.size !== (position && position.height)) {\r\n\t\t\t\tspace.height.size = position && position.height;\r\n\t\t\t\tspace.height.resized = 0;\r\n\t\t\t\tspace.height.adjusted = [];\r\n\t\t\t\tchanged = true;\r\n\t\t\t}\r\n\r\n\t\t\tif (coalesce(space.order, 0) !== coalesce(order, 0)) {\r\n\t\t\t\tspace.order = coalesce(order, 0)!;\r\n\t\t\t\tchanged = true;\r\n\t\t\t}\r\n\r\n\t\t\tif (coalesce(space.zIndex, 0) !== coalesce(zIndex, 0)) {\r\n\t\t\t\tspace.zIndex = coalesce(zIndex, 0)!;\r\n\t\t\t\tchanged = true;\r\n\t\t\t}\r\n\r\n\t\t\tif (coalesce(space.scrollable, false) !== coalesce(scrollable, false)) {\r\n\t\t\t\tspace.scrollable = coalesce(scrollable, false)!;\r\n\t\t\t\tchanged = true;\r\n\t\t\t}\r\n\r\n\t\t\tif (space.minimumSize !== minimumSize) {\r\n\t\t\t\tspace.minimumSize = minimumSize;\r\n\t\t\t\tchanged = true;\r\n\t\t\t}\r\n\r\n\t\t\tif (space.maximumSize !== maximumSize) {\r\n\t\t\t\tspace.maximumSize = maximumSize;\r\n\t\t\t\tchanged = true;\r\n\t\t\t}\r\n\r\n\t\t\tif (coalesce(space.centerContent, CenterType.None) !== coalesce(centerContent, CenterType.None)) {\r\n\t\t\t\tspace.centerContent = coalesce(centerContent, CenterType.None)!;\r\n\t\t\t\tchanged = true;\r\n\t\t\t}\r\n\r\n\t\t\tif (space.handleSize !== handleSize) {\r\n\t\t\t\tspace.handleSize = handleSize || spaceDefaults.handleSize!;\r\n\t\t\t\tchanged = true;\r\n\t\t\t}\r\n\r\n\t\t\tif (space.touchHandleSize !== touchHandleSize) {\r\n\t\t\t\tspace.touchHandleSize = touchHandleSize || spaceDefaults.touchHandleSize!;\r\n\t\t\t\tchanged = true;\r\n\t\t\t}\r\n\r\n\t\t\tif (space.handlePlacement !== handlePlacement) {\r\n\t\t\t\tspace.handlePlacement = handlePlacement || spaceDefaults.handlePlacement!;\r\n\t\t\t\tchanged = true;\r\n\t\t\t}\r\n\r\n\t\t\tif (space.canResizeBottom !== canResizeBottom) {\r\n\t\t\t\tspace.canResizeBottom = canResizeBottom;\r\n\t\t\t\tchanged = true;\r\n\t\t\t}\r\n\r\n\t\t\tif (space.canResizeTop !== canResizeTop) {\r\n\t\t\t\tspace.canResizeTop = canResizeTop;\r\n\t\t\t\tchanged = true;\r\n\t\t\t}\r\n\r\n\t\t\tif (space.canResizeLeft !== canResizeLeft) {\r\n\t\t\t\tspace.canResizeLeft = canResizeLeft;\r\n\t\t\t\tchanged = true;\r\n\t\t\t}\r\n\r\n\t\t\tif (space.canResizeRight !== canResizeRight) {\r\n\t\t\t\tspace.canResizeRight = canResizeRight;\r\n\t\t\t\tchanged = true;\r\n\t\t\t}\r\n\r\n\t\t\tif (space.canResizeTopLeft !== canResizeTopLeft) {\r\n\t\t\t\tspace.canResizeTopLeft = canResizeTopLeft;\r\n\t\t\t\tchanged = true;\r\n\t\t\t}\r\n\r\n\t\t\tif (space.canResizeTopRight !== canResizeTopRight) {\r\n\t\t\t\tspace.canResizeTopRight = canResizeTopRight;\r\n\t\t\t\tchanged = true;\r\n\t\t\t}\r\n\r\n\t\t\tif (space.canResizeBottomLeft !== canResizeBottomLeft) {\r\n\t\t\t\tspace.canResizeBottomLeft = canResizeBottomLeft;\r\n\t\t\t\tchanged = true;\r\n\t\t\t}\r\n\r\n\t\t\tif (space.canResizeBottomRight !== canResizeBottomRight) {\r\n\t\t\t\tspace.canResizeBottomRight = canResizeBottomRight;\r\n\t\t\t\tchanged = true;\r\n\t\t\t}\r\n\r\n\t\t\tif (space.allowOverflow !== allowOverflow) {\r\n\t\t\t\tspace.allowOverflow = allowOverflow || spaceDefaults.allowOverflow!;\r\n\t\t\t\tchanged = true;\r\n\t\t\t}\r\n\r\n\t\t\tif (changed) {\r\n\t\t\t\tif (space.parentId) {\r\n\t\t\t\t\tconst parentSpace = getSpace(space.parentId);\r\n\t\t\t\t\tif (parentSpace) {\r\n\t\t\t\t\t\trecalcSpaces(parentSpace);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tupdateStyleDefinition(space);\r\n\t\t\t}\r\n\t\t},\r\n\t\tcreateSpace: () => ({} as ISpaceDefinition),\r\n\t\tstartMouseResize: () => null,\r\n\t\tstartTouchResize: () => null,\r\n\t\tstartMouseDrag: () => null,\r\n\t\tstartTouchDrag: () => null,\r\n\t};\r\n\r\n\tconst resize = createResize(store);\r\n\tconst drag = createDrag(store);\r\n\r\n\tstore.createSpace = (parentId: string | undefined, props: ISpaceProps, update: () => void) => {\r\n\t\tconst { position, anchor, type, ...commonProps } = props;\r\n\t\tconst canResizeLeft = (position && position.rightResizable) || false;\r\n\t\tconst canResizeRight = (position && position.leftResizable) || false;\r\n\t\tconst canResizeTop = (position && position.bottomResizable) || false;\r\n\t\tconst canResizeBottom = (position && position.topResizable) || false;\r\n\t\tconst canResizeTopLeft = (position && position.topLeftResizable) || false;\r\n\t\tconst canResizeTopRight = (position && position.topRightResizable) || false;\r\n\t\tconst canResizeBottomLeft = (position && position.bottomLeftResizable) || false;\r\n\t\tconst canResizeBottomRight = (position && position.bottomRightResizable) || false;\r\n\r\n\t\tconst newSpace: ISpaceDefinition = {\r\n\t\t\t...spaceDefaults,\r\n\t\t\t...commonProps,\r\n\t\t\t...{\r\n\t\t\t\tstore: store,\r\n\t\t\t\tupdate: update,\r\n\t\t\t\tupdateParent: () => {\r\n\t\t\t\t\tif (parentId) {\r\n\t\t\t\t\t\tconst parentSpace = store.getSpace(parentId);\r\n\t\t\t\t\t\tif (parentSpace) {\r\n\t\t\t\t\t\t\tparentSpace.update();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tparentId: parentId,\r\n\t\t\t\tchildren: [],\r\n\t\t\t\tanchor: anchor,\r\n\t\t\t\ttype: type,\r\n\t\t\t\torientation: getOrientation(anchor),\r\n\t\t\t\tposition: getPosition(type),\r\n\t\t\t\tleft: sizeInfoDefault(position && position.left),\r\n\t\t\t\tright: sizeInfoDefault(position && position.right),\r\n\t\t\t\ttop: sizeInfoDefault(position && position.top),\r\n\t\t\t\tbottom: sizeInfoDefault(position && position.bottom),\r\n\t\t\t\twidth: sizeInfoDefault(position && position.width),\r\n\t\t\t\theight: sizeInfoDefault(position && position.height),\r\n\t\t\t\tcanResizeLeft: canResizeLeft,\r\n\t\t\t\tcanResizeRight: canResizeRight,\r\n\t\t\t\tcanResizeTop: canResizeTop,\r\n\t\t\t\tcanResizeBottom: canResizeBottom,\r\n\t\t\t\tcanResizeTopLeft: canResizeTopLeft,\r\n\t\t\t\tcanResizeTopRight: canResizeTopRight,\r\n\t\t\t\tcanResizeBottomLeft: canResizeBottomLeft,\r\n\t\t\t\tcanResizeBottomRight: canResizeBottomRight,\r\n\t\t\t},\r\n\t\t} as ISpaceDefinition;\r\n\r\n\t\tnewSpace.anchoredChildren = (children, chanchor, zIndex) => {\r\n\t\t\treturn children.filter((s) => s.type === Type.Anchored && s.anchor === chanchor && s.zIndex === zIndex);\r\n\t\t};\r\n\r\n\t\tnewSpace.adjustLeft = (adjusted) => {\r\n\t\t\tif (adjustmentsEqual(newSpace.left.adjusted, adjusted)) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\tnewSpace.left.adjusted = adjusted;\r\n\t\t\treturn true;\r\n\t\t};\r\n\r\n\t\tnewSpace.adjustRight = (adjusted) => {\r\n\t\t\tif (adjustmentsEqual(newSpace.right.adjusted, adjusted)) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\tnewSpace.right.adjusted = adjusted;\r\n\t\t\treturn true;\r\n\t\t};\r\n\r\n\t\tnewSpace.adjustTop = (adjusted) => {\r\n\t\t\tif (adjustmentsEqual(newSpace.top.adjusted, adjusted)) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\tnewSpace.top.adjusted = adjusted;\r\n\t\t\treturn true;\r\n\t\t};\r\n\r\n\t\tnewSpace.adjustBottom = (adjusted) => {\r\n\t\t\tif (adjustmentsEqual(newSpace.bottom.adjusted, adjusted)) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\tnewSpace.bottom.adjusted = adjusted;\r\n\t\t\treturn true;\r\n\t\t};\r\n\r\n\t\tif (type === Type.Anchored) {\r\n\t\t\tif (anchor === AnchorType.Left) {\r\n\t\t\t\tnewSpace.adjustEdge = newSpace.adjustLeft;\r\n\t\t\t} else if (anchor === AnchorType.Top) {\r\n\t\t\t\tnewSpace.adjustEdge = newSpace.adjustTop;\r\n\t\t\t} else if (anchor === AnchorType.Right) {\r\n\t\t\t\tnewSpace.adjustEdge = newSpace.adjustRight;\r\n\t\t\t} else if (anchor === AnchorType.Bottom) {\r\n\t\t\t\tnewSpace.adjustEdge = newSpace.adjustBottom;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn newSpace;\r\n\t};\r\n\r\n\tstore.startMouseResize = (resizeType, space, event, onResizeEnd) => {\r\n\t\tresize.startResize(\r\n\t\t\tevent,\r\n\t\t\tresizeType,\r\n\t\t\tspace,\r\n\t\t\tEndEvent.Mouse,\r\n\t\t\tMoveEvent.Mouse,\r\n\t\t\t(e) => ({\r\n\t\t\t\tx: e.clientX,\r\n\t\t\t\ty: e.clientY,\r\n\t\t\t}),\r\n\t\t\tonResizeEnd,\r\n\t\t);\r\n\t};\r\n\r\n\tstore.startTouchResize = (resizeType, space, event, onResizeEnd) => {\r\n\t\tresize.startResize(\r\n\t\t\tevent,\r\n\t\t\tresizeType,\r\n\t\t\tspace,\r\n\t\t\tEndEvent.Touch,\r\n\t\t\tMoveEvent.Touch,\r\n\t\t\t(e) => ({\r\n\t\t\t\tx: e.touches[0].clientX,\r\n\t\t\t\ty: e.touches[0].clientY,\r\n\t\t\t}),\r\n\t\t\tonResizeEnd,\r\n\t\t);\r\n\t};\r\n\r\n\tstore.startMouseDrag = (space, event, onDragEnd) => {\r\n\t\tdrag.startDrag(\r\n\t\t\tevent,\r\n\t\t\tspace,\r\n\t\t\tEndEvent.Mouse,\r\n\t\t\tMoveEvent.Mouse,\r\n\t\t\t(e) => ({\r\n\t\t\t\tx: e.clientX,\r\n\t\t\t\ty: e.clientY,\r\n\t\t\t}),\r\n\t\t\tonDragEnd,\r\n\t\t);\r\n\t};\r\n\r\n\tstore.startTouchDrag = (space, event, onDragEnd) => {\r\n\t\tdrag.startDrag(\r\n\t\t\tevent,\r\n\t\t\tspace,\r\n\t\t\tEndEvent.Touch,\r\n\t\t\tMoveEvent.Touch,\r\n\t\t\t(e) => ({\r\n\t\t\t\tx: e.touches[0].clientX,\r\n\t\t\t\ty: e.touches[0].clientY,\r\n\t\t\t}),\r\n\t\t\tonDragEnd,\r\n\t\t);\r\n\t};\r\n\r\n\treturn store;\r\n}\r\n","import * as React from \"react\";\r\nimport { createStore } from \"./core\";\r\nimport {\r\n\tISpaceProps,\r\n\tISpaceStore,\r\n\tISpaceDefinition,\r\n\tResizeType,\r\n\tCenterType,\r\n\tISpaceContext,\r\n\tICommonProps,\r\n\tResizeMouseEvent,\r\n\tOnDragEnd,\r\n\tResizeTouchEvent,\r\n} from \"./core-types\";\r\nimport { coalesce, shortuuid } from \"./core-utils\";\r\nimport { ResizeSensor } from \"css-element-queries\";\r\nimport * as PropTypes from \"prop-types\";\r\nimport { useEffect, useRef, useState } from \"react\";\r\n\r\n// WORKAROUND for React18 strict mode\r\n// https://blog.ag-grid.com/avoiding-react-18-double-mount/\r\nexport const useEffectOnce = (effect: () => void | (() => void)) => {\r\n\tconst destroyFunc = useRef<void | (() => void)>();\r\n\tconst effectCalled = useRef(false);\r\n\tconst renderAfterCalled = useRef(false);\r\n\tconst [_val, setVal] = useState<number>(0);\r\n\r\n\tif (effectCalled.current) {\r\n\t\trenderAfterCalled.current = true;\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\t\t// only execute the effect first time around\r\n\t\tif (!effectCalled.current) {\r\n\t\t\tdestroyFunc.current = effect();\r\n\t\t\teffectCalled.current = true;\r\n\t\t}\r\n\r\n\t\t// this forces one render after the effect is run\r\n\t\tsetVal((val) => val + 1);\r\n\r\n\t\treturn () => {\r\n\t\t\t// if the comp didn't render since the useEffect was called,\r\n\t\t\t// we know it's the dummy React cycle\r\n\t\t\tif (!renderAfterCalled.current) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (destroyFunc.current) {\r\n\t\t\t\tdestroyFunc.current();\r\n\t\t\t}\r\n\t\t};\r\n\t}, []);\r\n};\r\n\r\nexport const ParentContext = React.createContext<string | undefined>(undefined);\r\nexport const DOMRectContext = React.createContext<DOMRect | undefined>(undefined);\r\nexport const LayerContext = React.createContext<number | undefined>(undefined);\r\nexport const OptionsContext = React.createContext<IReactSpacesOptions>({});\r\nexport const currentStore = createStore();\r\n\r\nexport const commonProps = {\r\n\tid: PropTypes.string,\r\n\tclassName: PropTypes.string,\r\n\tstyle: PropTypes.oneOfType([PropTypes.object, PropTypes.array]),\r\n\tas: PropTypes.any,\r\n\tcenterContent: PropTypes.oneOf([CenterType.None, CenterType.Vertical, CenterType.HorizontalVertical]),\r\n\tzIndex: PropTypes.number,\r\n\tscrollable: PropTypes.bool,\r\n\ttrackSize: PropTypes.bool,\r\n\tallowOverflow: PropTypes.bool,\r\n\thandleRender: PropTypes.func,\r\n\tonClick: PropTypes.func,\r\n\tonDoubleClick: PropTypes.func,\r\n\tonMouseDown: PropTypes.func,\r\n\tonMouseEnter: PropTypes.func,\r\n\tonMouseLeave: PropTypes.func,\r\n\tonMouseMove: PropTypes.func,\r\n\tonTouchStart: PropTypes.func,\r\n\tonTouchMove: PropTypes.func,\r\n\tonTouchEnd: PropTypes.func,\r\n};\r\n\r\nexport interface IReactSpacesOptions {\r\n\tdebug?: boolean;\r\n}\r\n\r\nexport interface IReactEvents {\r\n\tonClick?: (event: React.MouseEvent<HTMLElement, MouseEvent>) => void;\r\n\tonDoubleClick?: (event: React.MouseEvent<HTMLElement, MouseEvent>) => void;\r\n\tonMouseDown?: (event: React.MouseEvent<HTMLElement, MouseEvent>) => void;\r\n\tonMouseEnter?: (event: React.MouseEvent<HTMLElement, MouseEvent>) => void;\r\n\tonMouseLeave?: (event: React.MouseEvent<HTMLElement, MouseEvent>) => void;\r\n\tonMouseMove?: (event: React.MouseEvent<HTMLElement, MouseEvent>) => void;\r\n\tonTouchStart?: (event: React.TouchEvent<HTMLElement>) => void;\r\n\tonTouchMove?: (event: React.TouchEvent<HTMLElement>) => void;\r\n\tonTouchEnd?: (event: React.TouchEvent<HTMLElement>) => void;\r\n}\r\n\r\nexport interface IReactSpaceCommonProps extends ICommonProps, IReactEvents {\r\n\tstyle?: React.CSSProperties;\r\n\tas?: keyof React.ReactDOM | React.ComponentType<ICommonProps>;\r\n\tchildren?: React.ReactNode;\r\n}\r\n\r\nexport interface IReactSpaceInnerProps extends IReactSpaceCommonProps, ISpaceProps, IReactEvents {\r\n\thandleRender?: (handleProps: IResizeHandleProps) => React.ReactNode;\r\n}\r\n\r\nexport interface IReactSpacesOptions {\r\n\tdebug?: boolean;\r\n}\r\n\r\nexport function useForceUpdate() {\r\n\tconst [, setTick] = React.useState(0);\r\n\treturn React.useCallback(() => {\r\n\t\tsetTick((tick) => tick + 1);\r\n\t}, []);\r\n}\r\n\r\nexport function useUniqueId() {\r\n\tif (SSR_SUPPORT_ENABLED) {\r\n\t\tif (React.version.startsWith(\"18\")) {\r\n\t\t\treturn `s${React.useId().replace(/\\:/g, \"\")}`;\r\n\t\t}\r\n\t}\r\n\r\n\treturn `s${shortuuid()}`;\r\n}\r\n\r\nexport function useSpace(props: IReactSpaceInnerProps) {\r\n\tconst store = currentStore;\r\n\tconst update = useForceUpdate();\r\n\tconst parent = React.useContext(ParentContext);\r\n\tconst layer = React.useContext(LayerContext);\r\n\tconst { debug } = React.useContext(OptionsContext);\r\n\tconst uniqueId = useUniqueId();\r\n\tconst [spaceId] = React.useState(props.id || uniqueId);\r\n\tconst elementRef = React.useRef<HTMLElement>();\r\n\tconst resizeSensor = React.useRef<ResizeSensor>();\r\n\tconst [domRect, setDomRect] = React.useState<DOMRect>();\r\n\r\n\tlet space = store.getSpace(spaceId)!;\r\n\r\n\tif (debug) {\r\n\t\tconsole.table(store.getSpaces());\r\n\t}\r\n\r\n\tconst parsedProps = {\r\n\t\t...props,\r\n\t\t...{\r\n\t\t\tid: spaceId,\r\n\t\t\tzIndex: coalesce(props.zIndex, layer),\r\n\t\t},\r\n\t};\r\n\r\n\tif (!space) {\r\n\t\tspace = store.createSpace(parent, parsedProps, update);\r\n\t\tstore.addSpace(space);\r\n\t} else {\r\n\t\tstore.updateSpace(space, parsedProps);\r\n\t}\r\n\r\n\tconst resizeHandles = useSpaceResizeHandles(store, space);\r\n\r\n\tuseEffectOnce(() => {\r\n\t\tconst rect = elementRef.current ? elementRef.current.getBoundingClientRect() : new DOMRect();\r\n\t\tspace.dimension = {\r\n\t\t\t...rect,\r\n\t\t\t...{\r\n\t\t\t\tleft: Math.floor(rect.left),\r\n\t\t\t\ttop: Math.floor(rect.top),\r\n\t\t\t\tright: Math.floor(rect.right),\r\n\t\t\t\tbottom: Math.floor(rect.bottom),\r\n\t\t\t\twidth: Math.floor(rect.width),\r\n\t\t\t\theight: Math.floor(rect.height),\r\n\t\t\t\tx: Math.floor(rect.x),\r\n\t\t\t\ty: Math.floor(rect.y),\r\n\t\t\t},\r\n\t\t};\r\n\t\tsetDomRect(space.dimension);\r\n\r\n\t\tif (props.trackSize) {\r\n\t\t\tresizeSensor.current = new ResizeSensor(elementRef.current!, (size) => {\r\n\t\t\t\tspace.dimension = {\r\n\t\t\t\t\t...rect,\r\n\t\t\t\t\t...{\r\n\t\t\t\t\t\twidth: Math.floor(size.width),\r\n\t\t\t\t\t\theight: Math.floor(size.height),\r\n\t\t\t\t\t},\r\n\t\t\t\t};\r\n\t\t\t\tsetDomRect(space.dimension);\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn () => {\r\n\t\t\tresizeSensor.current && resizeSensor.current.detach();\r\n\t\t\tstore.removeSpace(space);\r\n\t\t};\r\n\t});\r\n\r\n\treturn { space: space, resizeHandles: resizeHandles, domRect: domRect, elementRef: elementRef };\r\n}\r\n\r\nexport interface IResizeHandleProps {\r\n\tid?: string;\r\n\tkey: string | number;\r\n\tclassName?: string;\r\n\tonMouseDown: (e: React.MouseEvent<HTMLElement, MouseEvent>) => void;\r\n\tonTouchStart: (e: React.TouchEvent<HTMLElement>) => void;\r\n}\r\n\r\nconst resizeSetup = [\r\n\t{ id: \"ml\", className: \"resize-left\", resizeType: ResizeType.Left, condition: (space: ISpaceDefinition) => space.canResizeLeft },\r\n\t{ id: \"mr\", className: \"resize-right\", resizeType: ResizeType.Right, condition: (space: ISpaceDefinition) => space.canResizeRight },\r\n\t{ id: \"mt\", className: \"resize-top\", resizeType: ResizeType.Top, condition: (space: ISpaceDefinition) => space.canResizeTop },\r\n\t{ id: \"mb\", className: \"resize-bottom\", resizeType: ResizeType.Bottom, condition: (space: ISpaceDefinition) => space.canResizeBottom },\r\n\t{ id: \"mtl\", className: \"resize-top-left\", resizeType: ResizeType.TopLeft, condition: (space: ISpaceDefinition) => space.canResizeTopLeft },\r\n\t{ id: \"mtr\", className: \"resize-top-right\", resizeType: ResizeType.TopRight, condition: (space: ISpaceDefinition) => space.canResizeTopRight },\r\n\t{\r\n\t\tid: \"mbl\",\r\n\t\tclassName: \"resize-bottom-left\",\r\n\t\tresizeType: ResizeType.BottomLeft,\r\n\t\tcondition: (space: ISpaceDefinition) => space.canResizeBottomLeft,\r\n\t},\r\n\t{\r\n\t\tid: \"mbr\",\r\n\t\tclassName: \"resize-bottom-right\",\r\n\t\tresizeType: ResizeType.BottomRight,\r\n\t\tcondition: (space: ISpaceDefinition) => space.canResizeBottomRight,\r\n\t},\r\n];\r\n\r\nexport function useSpaceResizeHandles(store: ISpaceStore, space: ISpaceDefinition) {\r\n\tconst mouseHandles: IResizeHandleProps[] = [];\r\n\r\n\tconst setupResizeHandle = (id: string, className: string, resizeType: ResizeType) => {\r\n\t\tmouseHandles.push({\r\n\t\t\tid: `${space.id}-${id}`,\r\n\t\t\tkey: id,\r\n\t\t\tclassName: `spaces-resize-handle ${className}`,\r\n\t\t\tonMouseDown: (event) => store.startMouseResize(resizeType, space, event),\r\n\t\t\tonTouchStart: (event) => store.startTouchResize(resizeType, space, event),\r\n\t\t});\r\n\t};\r\n\r\n\tresizeSetup.forEach((resizeItem) => {\r\n\t\tif (resizeItem.condition(space)) {\r\n\t\t\tsetupResizeHandle(resizeItem.id, resizeItem.className, resizeItem.resizeType);\r\n\t\t}\r\n\t});\r\n\r\n\treturn {\r\n\t\tmouseHandles,\r\n\t};\r\n}\r\n\r\nexport function useCurrentSpace() {\r\n\tconst store = currentStore;\r\n\tconst spaceId = React.useContext(ParentContext);\r\n\r\n\tconst space = spaceId ? store.getSpace(spaceId) : undefined;\r\n\r\n\tconst domRect = React.useContext(DOMRectContext);\r\n\tconst layer = React.useContext(LayerContext);\r\n\tconst onMouseDrag = React.useCallback(\r\n\t\t(e: ResizeMouseEvent, onDragEnd: OnDragEnd | undefined) => (space ? store.startMouseDrag(space, e, onDragEnd) : null),\r\n\t\t[spaceId],\r\n\t);\r\n\tconst onTouchDrag = React.useCallback(\r\n\t\t(e: ResizeTouchEvent, onDragEnd: OnDragEnd | undefined) => (space ? store.startTouchDrag(space, e, onDragEnd) : null),\r\n\t\t[spaceId],\r\n\t);\r\n\tconst onForceUpdate = React.useCallback(() => (space ? store.updateStyles(space) : null), [spaceId]);\r\n\r\n\tconst defaults = { width: 0, height: 0, x: 0, y: 0 };\r\n\tconst size = {\r\n\t\t...defaults,\r\n\t\t...domRect,\r\n\t};\r\n\r\n\treturn {\r\n\t\tsize: size,\r\n\t\tlayer: layer || 0,\r\n\t\tstartMouseDrag: onMouseDrag,\r\n\t\tstartTouchDrag: onTouchDrag,\r\n\t\tforceUpdate: onForceUpdate,\r\n\t} as ISpaceContext;\r\n}\r\n\r\nexport let SSR_SUPPORT_ENABLED = false;\r\nexport function enabledSsrSupport() {\r\n\tSSR_SUPPORT_ENABLED = true;\r\n}\r\n","import * as React from \"react\";\r\n\r\ninterface IProps {\r\n\tchildren?: React.ReactNode;\r\n}\r\n\r\nexport const Centered: React.FC<IProps> = (props) => <div className={`spaces-centered`}>{props.children}</div>;\r\n","import * as React from \"react\";\r\n\r\ninterface IProps {\r\n\tchildren?: React.ReactNode;\r\n}\r\n\r\nexport const CenteredVertically: React.FC<IProps> = (props) => <div className={`spaces-centered-vertically`}>{props.children}</div>;\r\n","import { CenterType, ResizeHandlePlacement, AnchorType, Type } from \"../core-types\";\r\nimport {\r\n\tuseSpace,\r\n\tParentContext,\r\n\tLayerContext,\r\n\tDOMRectContext,\r\n\tIReactSpaceInnerProps,\r\n\tuseEffectOnce,\r\n\tSSR_SUPPORT_ENABLED,\r\n\tuseUniqueId,\r\n} from \"../core-react\";\r\nimport * as React from \"react\";\r\nimport { Centered } from \"./Centered\";\r\nimport { CenteredVertically } from \"./CenteredVertically\";\r\nimport { isServer, updateStyleDefinition } from \"../core-utils\";\r\n\r\nfunction applyCentering(children: React.ReactNode, centerType: CenterType | undefined) {\r\n\tswitch (centerType) {\r\n\t\tcase CenterType.Vertical:\r\n\t\t\treturn <CenteredVertically>{children}</CenteredVertically>;\r\n\t\tcase CenterType.HorizontalVertical:\r\n\t\t\treturn <Centered>{children}</Centered>;\r\n\t}\r\n\treturn children;\r\n}\r\n\r\nexport class Space extends React.Component<IReactSpaceInnerProps> {\r\n\tpublic render() {\r\n\t\treturn <SpaceInner {...this.props} wrapperInstance={this} />;\r\n\t}\r\n}\r\n\r\nconst SpaceInner: React.FC<IReactSpaceInnerProps & { wrapperInstance: Space }> = (props) => {\r\n\tlet idToUse = props.id ?? props.wrapperInstance[\"_react_spaces_uniqueid\"];\r\n\tconst [initialRender, setInitialRender] = React.useState(SSR_SUPPORT_ENABLED ? true : false);\r\n\r\n\tconst uniqueId = useUniqueId();\r\n\r\n\tif (!idToUse) {\r\n\t\tprops.wrapperInstance[\"_react_spaces_uniqueid\"] = uniqueId;\r\n\t\tidToUse = props.wrapperInstance[\"_react_spaces_uniqueid\"];\r\n\t}\r\n\r\n\tconst {\r\n\t\tstyle,\r\n\t\tclassName,\r\n\t\tonClick,\r\n\t\tonDoubleClick,\r\n\t\tonMouseDown,\r\n\t\tonMouseEnter,\r\n\t\tonMouseLeave,\r\n\t\tonMouseMove,\r\n\t\tonTouchStart,\r\n\t\tonTouchMove,\r\n\t\tonTouchEnd,\r\n\t\tchildren,\r\n\t\thandleRender,\r\n\t} = props;\r\n\r\n\tconst events = {\r\n\t\tonClick: onClick,\r\n\t\tonDoubleClick: onDoubleClick,\r\n\t\tonMouseDown: onMouseDown,\r\n\t\tonMouseEnter: onMouseEnter,\r\n\t\tonMouseLeave: onMouseLeave,\r\n\t\tonMouseMove: onMouseMove,\r\n\t\tonTouchStart: onTouchStart,\r\n\t\tonTouchMove: onTouchMove,\r\n\t\tonTouchEnd: onTouchEnd,\r\n\t};\r\n\r\n\tconst { space, domRect, elementRef, resizeHandles } = useSpace({\r\n\t\t...props,\r\n\t\t...{ id: idToUse },\r\n\t});\r\n\r\n\tif (SSR_SUPPORT_ENABLED && !isServer()) {\r\n\t\tconst preRenderedStyle = document.getElementById(`style_${idToUse}_ssr`);\r\n\t\tif (preRenderedStyle) {\r\n\t\t\tspace.ssrStyle = preRenderedStyle.innerHTML;\r\n\t\t}\r\n\t\tupdateStyleDefinition(space);\r\n\t}\r\n\r\n\tuseEffectOnce(() => {\r\n\t\tspace.element = elementRef.current!;\r\n\r\n\t\tif (SSR_SUPPORT_ENABLED) {\r\n\t\t\tif (initialRender) {\r\n\t\t\t\tsetInitialRender(false);\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n\r\n\tconst userClasses = className ? className.split(\" \").map((c) => c.trim()) : [];\r\n\r\n\tconst outerClasses = [\r\n\t\t...[\"spaces-space\", space.children.find((s) => s.resizing) ? \"spaces-resizing\" : undefined],\r\n\t\t...[space.type === Type.Fixed ? \"spaces-fixedsize-layout\" : undefined],\r\n\t\t...[space.type === Type.ViewPort ? \"spaces-fullpage-layout\" : undefined],\r\n\t\t...userClasses.map((c) => `${c}-container`),\r\n\t].filter((c) => c);\r\n\r\n\tconst innerClasses = [...[\"spaces-space-inner\"], ...userClasses];\r\n\r\n\tlet innerStyle = style;\r\n\tif (space.handlePlacement === ResizeHandlePlacement.Inside) {\r\n\t\tinnerStyle = {\r\n\t\t\t...style,\r\n\t\t\t...{\r\n\t\t\t\tleft: space.anchor === AnchorType.Right ? space.handleSize : undefined,\r\n\t\t\t\tright: space.anchor === AnchorType.Left ? space.handleSize : undefined,\r\n\t\t\t\ttop: space.anchor === AnchorType.Bottom ? space.handleSize : undefined,\r\n\t\t\t\tbottom: space.anchor === AnchorType.Top ? space.handleSize : undefined,\r\n\t\t\t},\r\n\t\t};\r\n\t}\r\n\r\n\tconst centeredContent = applyCentering(children, props.centerContent);\r\n\r\n\tconst outerProps = {\r\n\t\t...{\r\n\t\t\tid: space.id,\r\n\t\t\tref: elementRef,\r\n\t\t\tclassName: outerClasses.join(\" \"),\r\n\t\t},\r\n\t\t...events,\r\n\t} as any;\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t{resizeHandles.mouseHandles.map((handleProps) => handleRender?.(handleProps) || <div {...handleProps} />)}\r\n\t\t\t{SSR_SUPPORT_ENABLED && space.ssrStyle && initialRender && <style id={`style_${space.id}_ssr`}>{space.ssrStyle}</style>}\r\n\t\t\t{React.createElement(\r\n\t\t\t\tprops.as || \"div\",\r\n\t\t\t\touterProps,\r\n\t\t\t\t<div className={innerClasses.join(\" \")} style={innerStyle}>\r\n\t\t\t\t\t<ParentContext.Provider value={space.id}>\r\n\t\t\t\t\t\t<LayerContext.Provider value={undefined}>\r\n\t\t\t\t\t\t\t<DOMRectContext.Provider value={domRect}>{centeredContent}</DOMRectContext.Provider>\r\n\t\t\t\t\t\t</LayerContext.Provider>\r\n\t\t\t\t\t</ParentContext.Provider>\r\n\t\t\t\t</div>,\r\n\t\t\t)}\r\n\t\t</>\r\n\t);\r\n};\r\n","import { SizeUnit, Type, AnchorType, ResizeHandlePlacement } from \"../core-types\";\r\nimport * as React from \"react\";\r\nimport { Space } from \"./Space\";\r\nimport * as PropTypes from \"prop-types\";\r\nimport { commonProps, IReactSpaceCommonProps, IResizeHandleProps } from \"../core-react\";\r\n\r\nexport interface IResizableProps extends IReactSpaceCommonProps {\r\n\tsize: SizeUnit;\r\n\torder?: number;\r\n\thandleSize?: number;\r\n\ttouchHandleSize?: number;\r\n\thandlePlacement?: ResizeHandlePlacement;\r\n\thandleRender?: (handleProps: IResizeHandleProps) => React.ReactNode;\r\n\tminimumSize?: number;\r\n\tmaximumSize?: number;\r\n\tonResizeStart?: () => void | boolean;\r\n\tonResizeEnd?: (newSize: SizeUnit) => void;\r\n}\r\n\r\nexport const resizableProps = {\r\n\t...commonProps,\r\n\t...{\r\n\t\tsize: PropTypes.oneOfType([PropTypes.string, PropTypes.number]).isRequired,\r\n\t\torder: PropTypes.number,\r\n\t\thandleSize: PropTypes.number,\r\n\t\ttouchHandleSize: PropTypes.number,\r\n\t\thandlePlacement: PropTypes.oneOf([ResizeHandlePlacement.Inside, ResizeHandlePlacement.OverlayBoundary, ResizeHandlePlacement.OverlayInside]),\r\n\t\thandleRender: PropTypes.func,\r\n\t\tminimumSize: PropTypes.number,\r\n\t\tmaximumSize: PropTypes.number,\r\n\t\tonResizeStart: PropTypes.func,\r\n\t\tonResizeEnd: PropTypes.func,\r\n\t},\r\n};\r\n\r\nexport interface IAnchorProps extends IResizableProps {\r\n\tresizable?: boolean;\r\n}\r\n\r\nexport const anchoredProps = {\r\n\t...resizableProps,\r\n\t...{\r\n\t\tresizable: PropTypes.bool,\r\n\t},\r\n};\r\n\r\nexport const LeftResizable: React.FC<IResizableProps> = ({ children, size, ...props }) => (\r\n\t<Space {...props} type={Type.Anchored} anchor={AnchorType.Left} position={{ left: 0, top: 0, bottom: 0, rightResizable: true, width: size }}>\r\n\t\t{children}\r\n\t</Space>\r\n);\r\n\r\nLeftResizable.propTypes = resizableProps;\r\n\r\nexport const Left: React.FC<IAnchorProps> = ({ size, children, resizable, ...commonProps }) => (\r\n\t<Space\r\n\t\t{...commonProps}\r\n\t\ttype={Type.Anchored}\r\n\t\tanchor={AnchorType.Left}\r\n\t\tposition={{ left: 0, top: 0, bottom: 0, rightResizable: resizable, width: size }}>\r\n\t\t{children}\r\n\t</Space>\r\n);\r\n\r\nLeft.propTypes = anchoredProps;\r\n\r\nexport const TopResizable: React.FC<IResizableProps> = ({ children, size, ...props }) => (\r\n\t<Space {...props} type={Type.Anchored} anchor={AnchorType.Top} position={{ left: 0, top: 0, right: 0, bottomResizable: true, height: size }}>\r\n\t\t{children}\r\n\t</Space>\r\n);\r\n\r\nTopResizable.propTypes = resizableProps;\r\n\r\nexport const Top: React.FC<IAnchorProps> = ({ size, children, resizable, ...commonProps }) => (\r\n\t<Space\r\n\t\t{...commonProps}\r\n\t\ttype={Type.Anchored}\r\n\t\tanchor={AnchorType.Top}\r\n\t\tposition={{ left: 0, top: 0, right: 0, bottomResizable: resizable, height: size }}>\r\n\t\t{children}\r\n\t</Space>\r\n);\r\n\r\nTop.propTypes = anchoredProps;\r\n\r\nexport const RightResizable: React.FC<IResizableProps> = ({ children, size, ...props }) => (\r\n\t<Space {...props} type={Type.Anchored} anchor={AnchorType.Right} position={{ bottom: 0, top: 0, right: 0, leftResizable: true, width: size }}>\r\n\t\t{children}\r\n\t</Space>\r\n);\r\n\r\nRightResizable.propTypes = resizableProps;\r\n\r\nexport const Right: React.FC<IAnchorProps> = ({ size, children, resizable, ...commonProps }) => (\r\n\t<Space\r\n\t\t{...commonProps}\r\n\t\ttype={Type.Anchored}\r\n\t\tanchor={AnchorType.Right}\r\n\t\tposition={{ bottom: 0, top: 0, right: 0, leftResizable: resizable, width: size }}>\r\n\t\t{children}\r\n\t</Space>\r\n);\r\n\r\nRight.propTypes = anchoredProps;\r\n\r\nexport const BottomResizable: React.FC<IResizableProps> = ({ children, size, ...props }) => (\r\n\t<Space {...props} type={Type.Anchored} anchor={AnchorType.Bottom} position={{ bottom: 0, left: 0, right: 0, topResizable: true, height: size }}>\r\n\t\t{children}\r\n\t</Space>\r\n);\r\n\r\nBottomResizable.propTypes = resizableProps;\r\n\r\nexport const Bottom: React.FC<IAnchorProps> = ({ size, children, resizable, ...commonProps }) => (\r\n\t<Space\r\n\t\t{...commonProps}\r\n\t\ttype={Type.Anchored}\r\n\t\tanchor={AnchorType.Bottom}\r\n\t\tposition={{ bottom: 0, left: 0, right: 0, topResizable: resizable, height: size }}>\r\n\t\t{children}\r\n\t</Space>\r\n);\r\n\r\nBottom.propTypes = anchoredProps;\r\n","import { Type, SizeUnit, IPositionalProps, AnchorType, ResizeType } from \"../core-types\";\r\nimport * as React from \"react\";\r\nimport { Space } from \"./Space\";\r\nimport * as PropTypes from \"prop-types\";\r\nimport { IReactSpaceCommonProps } from \"../core-react\";\r\nimport { anchoredProps, IAnchorProps } from \"./Anchored\";\r\nimport { omit } from \"../core-utils\";\r\n\r\ntype ICustomProps = Omit<IReactSpaceCommonProps & IAnchorProps, \"size\"> & {\r\n\ttype?: Type;\r\n\r\n\t// Anchored\r\n\tanchor?: AnchorType;\r\n\tanchorSize?: SizeUnit;\r\n\r\n\t// Positioned\r\n\tleft?: SizeUnit | undefined;\r\n\ttop?: SizeUnit | undefined;\r\n\tright?: SizeUnit | undefined;\r\n\tbottom?: SizeUnit | undefined;\r\n\twidth?: SizeUnit | undefined;\r\n\theight?: SizeUnit | undefined;\r\n\tresizeTypes?: ResizeType[];\r\n};\r\n\r\nconst customProps = omit(\r\n\t{\r\n\t\t...anchoredProps,\r\n\t\t...{\r\n\t\t\ttype: PropTypes.oneOf([Type.Positioned, Type.Fill, Type.Anchored]),\r\n\r\n\t\t\tanchor: PropTypes.oneOf([AnchorType.Left, AnchorType.Top, AnchorType.Right, AnchorType.Bottom]),\r\n\t\t\tanchorSize: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\r\n\r\n\t\t\tleft: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\r\n\t\t\ttop: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\r\n\t\t\tright: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\r\n\t\t\tbottom: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\r\n\t\t\twidth: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\r\n\t\t\theight: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\r\n\t\t\tresizeTypes: PropTypes.array,\r\n\t\t},\r\n\t},\r\n\t\"size\",\r\n);\r\n\r\nexport const Custom: React.FC<ICustomProps> = ({\r\n\tchildren,\r\n\ttype,\r\n\tleft,\r\n\ttop,\r\n\tright,\r\n\tbottom,\r\n\twidth,\r\n\theight,\r\n\tanchorSize,\r\n\tanchor,\r\n\tresizable,\r\n\tresizeTypes,\r\n\t...props\r\n}) => {\r\n\tlet position: IPositionalProps;\r\n\ttype = type || Type.Fill;\r\n\r\n\tif (type === Type.Positioned) {\r\n\t\tposition = {\r\n\t\t\tleft: left,\r\n\t\t\ttop: top,\r\n\t\t\tright: right,\r\n\t\t\tbottom: bottom,\r\n\t\t\twidth: width,\r\n\t\t\theight: height,\r\n\t\t\tleftResizable: resizeTypes && (resizeTypes.includes(ResizeType.Left) || resizeTypes.includes(ResizeType.All)),\r\n\t\t\ttopResizable: resizeTypes && (resizeTypes.includes(ResizeType.Top) || resizeTypes.includes(ResizeType.All)),\r\n\t\t\trightResizable: resizeTypes && (resizeTypes.includes(ResizeType.Right) || resizeTypes.includes(ResizeType.All)),\r\n\t\t\tbottomResizable: resizeTypes && (resizeTypes.includes(ResizeType.Bottom) || resizeTypes.includes(ResizeType.All)),\r\n\t\t\ttopLeftResizable: resizeTypes && (resizeTypes.includes(ResizeType.TopLeft) || resizeTypes.includes(ResizeType.All)),\r\n\t\t\ttopRightResizable: resizeTypes && (resizeTypes.includes(ResizeType.TopRight) || resizeTypes.includes(ResizeType.All)),\r\n\t\t\tbottomLeftResizable: resizeTypes && (resizeTypes.includes(ResizeType.BottomLeft) || resizeTypes.includes(ResizeType.All)),\r\n\t\t\tbottomRightResizable: resizeTypes && (resizeTypes.includes(ResizeType.BottomRight) || resizeTypes.includes(ResizeType.All)),\r\n\t\t};\r\n\t} else {\r\n\t\tif (anchor === AnchorType.Left) {\r\n\t\t\tposition = { left: 0, top: 0, bottom: 0, width: anchorSize, rightResizable: resizable };\r\n\t\t\ttype = Type.Anchored;\r\n\t\t} else if (anchor === AnchorType.Right) {\r\n\t\t\tposition = { right: 0, top: 0, bottom: 0, width: anchorSize, leftResizable: resizable };\r\n\t\t\ttype = Type.Anchored;\r\n\t\t} else if (anchor === AnchorType.Top) {\r\n\t\t\tposition = { left: 0, top: 0, right: 0, height: anchorSize, bottomResizable: resizable };\r\n\t\t\ttype = Type.Anchored;\r\n\t\t} else if (anchor === AnchorType.Bottom) {\r\n\t\t\tposition = { left: 0, bottom: 0, right: 0, height: anchorSize, topResizable: resizable };\r\n\t\t\ttype = Type.Anchored;\r\n\t\t} else {\r\n\t\t\tposition = {\r\n\t\t\t\tleft: 0,\r\n\t\t\t\ttop: 0,\r\n\t\t\t\tbottom: 0,\r\n\t\t\t\tright: 0,\r\n\t\t\t};\r\n\t\t\ttype = Type.Fill;\r\n\t\t}\r\n\t}\r\n\r\n\treturn (\r\n\t\t<Space {...props} type={type} anchor={anchor} position={position}>\r\n\t\t\t{children}\r\n\t\t</Space>\r\n\t);\r\n};\r\n\r\nCustom.propTypes = customProps;\r\n","import { Type } from \"../core-types\";\r\nimport * as React from \"react\";\r\nimport { Space } from \"./Space\";\r\nimport { commonProps, IReactSpaceCommonProps } from \"../core-react\";\r\n\r\nexport const Fill: React.FC<IReactSpaceCommonProps> = (props) => (\r\n\t<Space {...props} type={Type.Fill} position={{ left: 0, top: 0, right: 0, bottom: 0 }}>\r\n\t\t{props.children}\r\n\t</Space>\r\n);\r\n\r\nFill.propTypes = commonProps;\r\n","import { SizeUnit, Type } from \"../core-types\";\r\nimport * as React from \"react\";\r\nimport { Space } from \"./Space\";\r\nimport * as PropTypes from \"prop-types\";\r\nimport { commonProps, IReactSpaceCommonProps } from \"../core-react\";\r\n\r\ninterface IFixedProps extends IReactSpaceCommonProps {\r\n\twidth?: SizeUnit;\r\n\theight: SizeUnit;\r\n}\r\n\r\nexport const Fixed: React.FC<IFixedProps> = ({ width, height, children, ...commonProps }) => (\r\n\t<Space {...commonProps} type={Type.Fixed} position={{ width: width, height: height }}>\r\n\t\t{children}\r\n\t</Space>\r\n);\r\n\r\nFixed.propTypes = {\r\n\t...commonProps,\r\n\t...{\r\n\t\twidth: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\r\n\t\theight: PropTypes.oneOfType([PropTypes.string, PropTypes.number]).isRequired,\r\n\t},\r\n};\r\n","import * as React from \"react\";\r\nimport { LayerContext } from \"../core-react\";\r\nimport * as PropTypes from \"prop-types\";\r\n\r\ninterface IProps {\r\n\tzIndex: number;\r\n\tchildren?: React.ReactNode;\r\n}\r\n\r\nexport const Layer: React.FC<IProps> = (props) => <LayerContext.Provider value={props.zIndex}>{props.children}</LayerContext.Provider>;\r\n\r\nLayer.propTypes = {\r\n\tzIndex: PropTypes.number.isRequired,\r\n};\r\n","import { Type, SizeUnit, ResizeType } from \"../core-types\";\r\nimport * as React from \"react\";\r\nimport { Space } from \"./Space\";\r\nimport * as PropTypes from \"prop-types\";\r\nimport { commonProps, IReactSpaceCommonProps } from \"../core-react\";\r\n\r\ninterface IPositionedProps extends IReactSpaceCommonProps {\r\n\tleft?: SizeUnit;\r\n\ttop?: SizeUnit;\r\n\tright?: SizeUnit;\r\n\tbottom?: SizeUnit;\r\n\twidth?: SizeUnit;\r\n\theight?: SizeUnit;\r\n\tresizable?: ResizeType[];\r\n\tonResizeStart?: () => void | boolean;\r\n\tonResizeEnd?: (newSize: SizeUnit) => void;\r\n}\r\n\r\nexport const Positioned: React.FC<IPositionedProps> = ({ left, top, right, bottom, width, height, resizable, ...props }) => {\r\n\tconst resizeTypes = resizable || [];\r\n\r\n\treturn (\r\n\t\t<Space\r\n\t\t\t{...props}\r\n\t\t\ttype={Type.Positioned}\r\n\t\t\tposition={{\r\n\t\t\t\tleft: left,\r\n\t\t\t\ttop: top,\r\n\t\t\t\tright: right,\r\n\t\t\t\tbottom: bottom,\r\n\t\t\t\tleftResizable: resizeTypes.includes(ResizeType.Left) || resizeTypes.includes(ResizeType.All),\r\n\t\t\t\ttopResizable: resizeTypes.includes(ResizeType.Top) || resizeTypes.includes(ResizeType.All),\r\n\t\t\t\trightResizable: resizeTypes.includes(ResizeType.Right) || resizeTypes.includes(ResizeType.All),\r\n\t\t\t\tbottomResizable: resizeTypes.includes(ResizeType.Bottom) || resizeTypes.includes(ResizeType.All),\r\n\t\t\t\ttopLeftResizable: resizeTypes.includes(ResizeType.TopLeft) || resizeTypes.includes(ResizeType.All),\r\n\t\t\t\ttopRightResizable: resizeTypes.includes(ResizeType.TopRight) || resizeTypes.includes(ResizeType.All),\r\n\t\t\t\tbottomLeftResizable: resizeTypes.includes(ResizeType.BottomLeft) || resizeTypes.includes(ResizeType.All),\r\n\t\t\t\tbottomRightResizable: resizeTypes.includes(ResizeType.BottomRight) || resizeTypes.includes(ResizeType.All),\r\n\t\t\t\twidth: width,\r\n\t\t\t\theight: height,\r\n\t\t\t}}>\r\n\t\t\t{props.children}\r\n\t\t</Space>\r\n\t);\r\n};\r\n\r\nPositioned.propTypes = {\r\n\t...commonProps,\r\n\t...{\r\n\t\tleft: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\r\n\t\ttop: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\r\n\t\tright: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\r\n\t\tbottom: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\r\n\t\twidth: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\r\n\t\theight: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\r\n\t\tresizable: PropTypes.array,\r\n\t},\r\n};\r\n","import * as React from \"react\";\r\nimport { DOMRectContext } from \"../core-react\";\r\n\r\ninterface ISpaceInfoProps {\r\n\tchildren: (info: DOMRect) => JSX.Element;\r\n}\r\n\r\n/**\r\n * @deprecated use useCurrentSpace() hook instead\r\n */\r\nexport const Info: React.FC<ISpaceInfoProps> = (props) => {\r\n\tconst domRect = React.useContext(DOMRectContext);\r\n\r\n\tif (domRect) {\r\n\t\treturn props.children(domRect);\r\n\t}\r\n\r\n\treturn props.children({ left: 0, top: 0, right: 0, bottom: 0, width: 0, height: 0, x: 0, y: 0, toJSON: () => \"\" });\r\n};\r\n","import { Type, SizeUnit } from \"../core-types\";\r\nimport * as React from \"react\";\r\nimport { Space } from \"./Space\";\r\nimport * as PropTypes from \"prop-types\";\r\nimport { commonProps, IReactSpaceCommonProps } from \"../core-react\";\r\n\r\ninterface IViewPortProps extends IReactSpaceCommonProps {\r\n\tleft?: SizeUnit;\r\n\tright?: SizeUnit;\r\n\ttop?: SizeUnit;\r\n\tbottom?: SizeUnit;\r\n}\r\n\r\nexport const ViewPort: React.FC<IViewPortProps> = ({ left, top, right, bottom, children, ...commonProps }) => (\r\n\t<Space {...commonProps} type={Type.ViewPort} position={{ left: left || 0, top: top || 0, right: right || 0, bottom: bottom || 0 }}>\r\n\t\t{children}\r\n\t</Space>\r\n);\r\n\r\nViewPort.propTypes = {\r\n\t...commonProps,\r\n\t...{\r\n\t\tleft: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\r\n\t\ttop: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\r\n\t\tright: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\r\n\t\tbottom: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\r\n\t},\r\n};\r\n","import * as React from \"react\";\nimport { enabledSsrSupport } from \"../core-react\";\nimport css from \"../styles.css\";\n\nexport const SSR: React.FC<{ children?: React.ReactNode }> = ({ children }) => {\n\tenabledSsrSupport();\n\treturn (\n\t\t<>\n\t\t\t<style dangerouslySetInnerHTML={{ __html: css }} />\n\t\t\t{children}\n\t\t</>\n\t);\n};\n","import * as React from \"react\";\r\nimport { IReactSpacesOptions, OptionsContext } from \"../core-react\";\r\n\r\ninterface IProps extends IReactSpacesOptions {\r\n\tchildren?: React.ReactNode;\r\n}\r\n\r\nexport const Options: React.FC<IProps> = ({ children, ...opts }) => {\r\n\treturn <OptionsContext.Provider value={opts}>{children}</OptionsContext.Provider>;\r\n};\r\n"],"names":["Orientation","MoveEvent","EndEvent","omit","object","_i","keys","keySet","Object","create","forEach","key","result","shortuuid","firstPart","Math","random","secondPart","toString","slice","getSizeString","size","css","dontAddCalc","adjusted","length","resized","parts","undefined","push","l","join","coalesce","args","find","x","adjustmentsEqual","item1","item2","i","len","throttle","callback","limit","wait","setTimeout","styleDefinition","space","cssElements","style","position","left","top","right","bottom","width","height","zIndex","cssString","allowOverflow","id","scrollable","nhandleOffset","handleSize","touchHandleSize","negativeTouchHandleSize","handlePlacement","ResizeHandlePlacement","Inside","OverlayInside","type","Type","Positioned","OverlayBoundary","addHandleCss","pos","styles","widthOrHeightSpecified","orientation","Horizontal","handleOffset","canResizeLeft","anchor","canResizeTop","canResizeRight","canResizeBottom","canResizeTopLeft","canResizeTopRight","canResizeBottomLeft","canResizeBottomRight","updateStyleDefinition","definition","isServer","ssrStyle","existing","document","getElementById","innerHTML","newStyle","createElement","head","appendChild","removeStyleDefinition","removeChild","isHorizontal","resizeType","ResizeType","Left","Right","createSideAdjuster","rect","dimensionToAdjust","originalX","originalY","negater","Bottom","val","candidateOppositeDimensionToAdjust","offset1","offset2","minimumAdjust","minimumSize","maximumAdjust","maximumSize","currentX","currentY","adjustment","dimensionResized","max","createAdjuster","element","getBoundingClientRect","Top","TopLeft","topAdjuster_1","leftAdjuster_1","y","TopRight","top1Adjuster_1","rightAdjuster_1","BottomLeft","bottomAdjuster_1","left1Adjuster_1","BottomRight","bottom1Adjuster_1","right1Adjuster_1","createResize","store","startResize","e","endEvent","moveEvent","getCoords","onResizeEnd","onResizeStart","originalCoords","adjuster","resizing","updateParent","resize","updateStyles","withPreventDefault","moved","newCoords","lastX","lastY","preventDefault","window","requestAnimationFrame","removeListener","removeEventListener","resizeEnd","currentRect","floor","addEventListener","createDrag","startDrag","onDragEnd","coords","adjustedLeft","adjustedTop","originalMouseX_1","originalMouseY_1","lastX_1","lastY_1","moved_1","mouseMove_1","adjustmentX","adjustmentY","throttledMouseMove_1","withPreventDefault_1","removeListener_1","_a","parentInfo","parentId","getSpace","info","AnchorType","CenterType","spaceDefaults","centerContent","dimension","toJSON","adjustLeft","adjustRight","adjustTop","adjustBottom","adjustEdge","anchoredChildren","anchorTypes","getPosition","ViewPort","Fixed","getOrientation","Vertical","anchorUpdates","update","sizeInfoDefault","createStore","getSpaces","s","recalcSpaces","parent","spaces","onlyUnique","value","index","self","indexOf","orderedSpaces","children","t","anchoredSpaces","filter","map","anchoredSpacesInLayer","c","order","unorderedSpaces","maxOrder","a","reduce","b","idx","changed","Fill","as","Anchored","adjusted_1","addSpace","parentSpace","removeSpace","newSpaces","parent_1","updateSpace","props","leftResizable","rightResizable","topResizable","bottomResizable","topLeftResizable","topRightResizable","bottomLeftResizable","bottomRightResizable","None","createSpace","startMouseResize","startTouchResize","startMouseDrag","startTouchDrag","drag","commonProps","newSpace","__assign","chanchor","event","Mouse","clientX","clientY","Touch","touches","useEffectOnce","effect","destroyFunc","useRef","effectCalled","renderAfterCalled","useState","setVal","current","useEffect","ParentContext","React","createContext","DOMRectContext","LayerContext","OptionsContext","currentStore","PropTypes","string","className","oneOfType","array","any","oneOf","HorizontalVertical","number","bool","trackSize","handleRender","func","onClick","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onTouchStart","onTouchMove","onTouchEnd","useForceUpdate","setTick","useCallback","tick","useUniqueId","SSR_SUPPORT_ENABLED","version","startsWith","useId","replace","useSpace","useContext","layer","debug","uniqueId","spaceId","elementRef","resizeSensor","domRect","setDomRect","console","table","parsedProps","resizeHandles","useSpaceResizeHandles","DOMRect","ResizeSensor","detach","resizeSetup","condition","mouseHandles","resizeItem","useCurrentSpace","onMouseDrag","onTouchDrag","onForceUpdate","forceUpdate","enabledSsrSupport","Centered","CenteredVertically","applyCentering","centerType","__extends","Space","SpaceInner","this","wrapperInstance","Component","idToUse","_b","initialRender","setInitialRender","events","_c","preRenderedStyle","userClasses","split","trim","outerClasses","__spreadArray","innerClasses","innerStyle","centeredContent","outerProps","ref","handleProps","Provider","resizableProps","isRequired","anchoredProps","resizable","LeftResizable","propTypes","TopResizable","RightResizable","BottomResizable","customProps","anchorSize","resizeTypes","Custom","includes","All","Layer","Info","SSR","dangerouslySetInnerHTML","__html","Options","opts"],"mappings":"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"}